(()=>{"use strict";var __webpack_modules__={64904:(e,t,o)=>{o.d(t,{cutTextToHighlight:()=>s});var i="cutTextToHighlight",r=15;function s(e){var t=null;document.querySelectorAll(`${e}:not(.cutTextToHighlight)`).forEach((e=>{if(e.classList.add(i),null===t){var o=getComputedStyle(e).font;t=function(e){var t=document.createElement("canvas").getContext("2d");function o(e){var o=t.measureText(e).width;return Math.ceil(o)}return t.font=e,o}(o)}e.innerHTML=function(e,t,o){void 0===o&&(o="…");var i=e.querySelector(".highlight");if(!i)return e.innerHTML;var s=e.innerHTML.indexOf('<em class="highlight">');if(i.offsetLeft+i.offsetWidth<=e.offsetWidth-r)return e.innerHTML;if(i.offsetWidth<e.offsetWidth-r){for(var n=0,_="",a=s;a>0&&n+i.offsetWidth<=e.offsetWidth;){var c=e.innerHTML.lastIndexOf(" ",a-1);if(-1===c&&(c=0),!((n=t(o+(_=e.innerHTML.substring(c,a)+_).trim()))+i.offsetWidth<=e.offsetWidth-r))break;a=c}s=a}if(s>0)return o+e.innerHTML.substring(s).trim();return e.innerHTML}(e,t)}))}},34010:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{evalWithLogging:()=>evalWithLogging});var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(87481),evalWithLogging=evalString=>{try{return eval(evalString)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,evalString)}}},67784:(e,t,o)=>{o.d(t,{addDelegateEvent:()=>_,removeDelegateEvent:()=>a});o(91181),o(56997),o(96253),o(19371),o(98837),o(51876);var i=o(15544),r=o(49535),s=new window.Map;function n(e){var t=s.get(e.currentTarget);if(t){var o=t[e.type];if(o)for(var r,n=0;n<o.length;n++){var _=o[n],a=_[0],c=_[1],l=void 0;if((0,i.hasClass)(e.target,a)?l=c(e,e.target):(r=(0,i.gpeByClass)(a,e.target,e.currentTarget))&&(l=c(e,r)),!1===l)break}}}function _(e,t,o,i,_){var a=s.get(e);a||(s.set(e,{}),a=s.get(e));for(var c=t.split(" "),l=0;l<c.length;l++){var d=c[l];a[d]||(a[d]=[],_?(0,r.addEvent)(e,d,n,!1,!1,_):(0,r.addEvent)(e,d,n)),a[d].push([o,i])}}function a(e,t,o,i){var _=s.get(e);_&&(t.split(" ").forEach((t=>{_[t]&&(_[t]=_[t].filter((e=>e[0]!==o||e[1]!==i)),0===_[t].length&&(0,r.removeEvent)(e,t,n))})),0===Object.keys(_).map((e=>_[e].length)).reduce(((e,t)=>e+t))&&s.delete(e))}},98530:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{searcher:()=>searcher,iSearch:()=>iSearch});var core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(79665),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(95767),core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30522),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(66108),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(96253),core_js_modules_es6_array_slice__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(50110),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(21466),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(95724),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(26271),_web_lib_market__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(87910),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(35429),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(79957),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(50167),_web_lib_fx__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(35676),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3834),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(49535),_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(60615),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(87481),_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(15544),_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(86409),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(54612),_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(86067),_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(40906),_shared_search_cutTextToHighlight_cutTextToHighlight__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(64904),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(76852),_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(40962),_web_ecomm_market_MarketSearchBanner_utils_hideFeaturing__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(99995),_web_search_init__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(50733);function _createForOfIteratorHelperLoose(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return(o=o.call(e)).next.bind(o);if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var sectionAuto="auto",sectionAudio="audio",sectionVideo="video",sectionClips="clips",sectionStatuses="statuses",sectionPeople="people",sectionCommunities="communities",sectionMiniApps="mini_apps",sectionQuick="quick",moduleEmpty=void 0,moduleFriends="friends",moduleGroupsCatalog="groups_catalog",moduleGroupsRecommendations="groups_recommendations",paramQuery="c[q]",paramSection="c[section]",paramCategory="c[category]",paramSort="c[sort]",paramPhoto="c[photo]",paramInvite="c[invite]",paramSkipCatalog="c[skip_catalog]",paramHd="c[hd]",paramGroupsRecommendationsModel="c[need_groups_recommendations_model]",paramFrom="c[from]",paramBlockPosition="c[block_position]",searcher={initSearchStatusFilters:_web_search_init__WEBPACK_IMPORTED_MODULE_25__.initSearchStatusFilters,init(e){var t=globalHistory.length;t&&globalHistory[t-1]&&globalHistory[t-1].loc.indexOf("search")?cur.search_return_to=globalHistory[t-1].loc:cur.search_return_to="/",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)("header");var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_query");if(!(o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.data)(o,"opts")||{}).isNew){var i=window.iSearch;i.destroy(),vk.id&&i.init(o,e)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.elfocus)(o),"search"===nav.objLoc[0]&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(cur,{oid:e.user_id,module:"search"}),cur.nav.push(((e,t,o)=>{if(void 0!==e[0]||cur.searchLoc&&void 0!==e.act)return clearTimeout(cur.setLocTO),void(nav.strLoc!==cur.loc&&cur.loc&&hab.setLoc(cur.loc));if(cur.searchLoc){var i=!1;for(var r in o)if("c["===r.substr(0,2)){i=!0;break}if(cur.onLocationChange&&cur.onLocationChange(i),!i)return!0}var s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.clone)(o);delete s[0];var n=s[paramSection]||s.section||sectionQuick;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_menu")&&uiRightMenu&&uiRightMenu.switchMenu((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)(`search_menu_${n}`,"search_menu")),searcher.setSection(n),searcher.sendSearchReq(s,!0),!1}))),cur.options||(cur.options={reply_names:{}}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(cur.options,e),searcher.applyOptions(e),o.ignoreFixed=cur.section==sectionStatuses,window.scrollTop=bodyNode.scrollTop=pageNode.scrollTop=htmlNode.scrollTop=0,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(window,"scroll",searcher.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(window,"resize",searcher.onResize),setTimeout(searcher.scrollCheck,50),setTimeout(_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_10__.checkPageBlocks,200);var r=window.audioPlayer;r&&r.showCurrentTrack&&r.showCurrentTrack(),cur._back={text:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)("search_back_to"),show:[()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)("header");var t=globalHistory.length;t&&globalHistory[t-1]&&globalHistory[t-1].loc.indexOf("search")&&(cur.search_return_to=globalHistory[t-1].loc),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(window,"scroll",searcher.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(window,"resize",searcher.onResize);var o=window.iSearch;o.destroy(),vk.id&&o.init((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_query"),e)}],hide:[()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(window,"scroll",searcher.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(window,"resize",searcher.onResize),window.iSearch.destroy()}]},cur.module===moduleGroupsCatalog&&(0,_shared_search_cutTextToHighlight_cutTextToHighlight__WEBPACK_IMPORTED_MODULE_26__.cutTextToHighlight)(".labeled__searchServicesDesc"),this.logSearch(cur.params,e)},sendSearchReq(e,t){if(cur.searchReq)try{cur.searchReq.abort()}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)(e)}t&&!e.offset&&(vk.no_ads=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.inArray)(e[paramSection],[sectionAudio]),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(e,{uf:1})),void 0!==cur.useRec&&(e.rec=cur.useRec,delete cur.useRec),e.edit=nav.objLoc.edit,e.sign=nav.objLoc.sign,e.all=nav.objLoc.all,e.change=1,cur.searchLoc&&(e.search_loc=cur.searchLoc),void 0!==cur.topType&&(e.type=cur.topType,delete cur.topType);var o=window.iSearch;o&&o.select&&(o.select.hide(),delete cur.setISearch),cur.loadingMedia||(uiSearch.showProgress("search_query"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_query").ignoreFixed=e[paramSection]==sectionStatuses),nav.objLoc.from&&(e.from=nav.objLoc.from);var i=this.removeLogClickHandlers,r=this.logSearch;e.act="search_request",e.module=cur.module;var s=+new Date;cur.searchReq=ajax.post("al_search.php",e,{onDone(o,n,_,a){window.cur.onSearchOrSectionChange&&window.cur.onSearchOrSectionChange.forEach((e=>e())),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)(document.querySelector(".search_seo_info"));var c=e.uf&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("results_wrap")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("results_wrap"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("results"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("friends_filters_block")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("friends_filters_block"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("filter_form");if(c.innerHTML=n||"",t&&(l&&(l.innerHTML=_||""),c.setAttribute("style",a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.elfocus)("search_query")),o.loc){var d=`${locProtocol}//${location.host}/${o.loc}`,u=document.URL===d?"":document.URL;setTimeout(_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_24__.updateCounters.pbind(d,u),10)}searcher.applyOptions(o,t),uiSearch.hideProgress("search_query"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)("search_clear_params");var h=window.audioPlayer;h&&h.showCurrentTrack&&h.showCurrentTrack(),cur.onSearchFinish&&cur.onSearchFinish(),(0,_web_lib_market__WEBPACK_IMPORTED_MODULE_9__.shortCurrency)(),setTimeout(_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_10__.checkPageBlocks,200),cur.onSearchDone&&cur.onSearchDone(),i();var p=+new Date-s;o.query_duration=o.query_duration||p,r(e,o)},onFail:()=>(uiSearch.hideProgress("search_query"),!0),showProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(`filter_${cur.section}`),"loading"),cur.isSearchLoading=!0},hideProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(`filter_${cur.section}`),"loading"),cur.isSearchLoading=!1,cur.loadingMedia=!1},ads:!(!t||e.offset)})},showMore(){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("ui_search_load_more"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_more_results");if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(e)&&!cur.isSearchLoading)if(t&&searcher.appendElements(t),cur.has_more){cur.disableAutoMore=!1,cur.isSearchLoading=!0,(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.lockButton)(e);var o=searcher.getSectionParams();o.offset=cur.offset,o.real_offset=cur.real_offset,o.query_id=cur.query_id,o.edit=nav.objLoc.edit,o.sign=nav.objLoc.sign,o.all=nav.objLoc.all,o.act="show_more",o.module=cur.module,cur.section===sectionCommunities&&(o.random_seed=cur.random_seed,o.force_group_id=cur.force_group_id),ajax.post("al_search.php",o,{onDone(t,o){cur.isSearchLoading=!1,o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("no_results")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.re)("no_results"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("results").insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ce)("div",{innerHTML:o,id:"search_more_results"}),e),cur.module===moduleGroupsCatalog&&(0,_shared_search_cutTextToHighlight_cutTextToHighlight__WEBPACK_IMPORTED_MODULE_26__.cutTextToHighlight)(".labeled__searchServicesDesc")),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.unlockButton)(e),searcher.applyOptions(t),searcher.scrollCheck()},cache:o[paramSection]!==sectionAudio||o[paramQuery]?1:0})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)(e);else t&&searcher.appendElements(t)},switchSection(e,t,o){if(o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(o))return!0;this.removeLogClickHandlers(),t=t||{},e!==sectionCommunities&&e!==sectionMiniApps||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(paramCategory,0),cur.filtersShown=!1);var i=searcher.getSectionParams(e);if(e!==sectionAuto&&e!==sectionQuick&&t.updateStats&&(i.swt=1),t.tab&&(i.tab=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_menu")&&uiRightMenu){var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)(`search_menu_${e}`,"search_menu");r&&uiRightMenu.switchMenu(r)}return searcher.setSection(e),searcher.sendSearchReq(i,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.gpeByClass)("ui_search","search_query"),"ui_search_fixed")&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(),!1},removeLogClickHandlers(){(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchAuto),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchPeople),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchStatuses),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchCommunities),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchAudio),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchVideo),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchClips),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceFriendsFind),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceGroupsCatalog)},logSearch(e,t){var o=e[paramQuery];if(o&&0!==(o=o.trim()).length){var i,r=cur.section,s=cur.module,n=cur.query_id,_=t.event_bits,a=t.event_bits_auto_blocks||[],c=t.query_duration,l=t.model_name,d=t.model_name_auto_blocks||[],u=t.is_anonym,h=!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("no_results")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_auto_rows")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_auto_rows").children.length>0;switch(r){case sectionAuto:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchAuto,searcher.logSearchAutoBlocks(i,o,n,_,a,d,u);break;case sectionAudio:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchAudio;break;case sectionVideo:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchVideo;break;case sectionClips:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchClips;break;case sectionStatuses:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchStatuses;break;case sectionPeople:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchPeople;break;case sectionCommunities:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceSearchCommunities;break;default:return}switch(s){case moduleFriends:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceFriendsFind;break;case moduleGroupsCatalog:i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceGroupsCatalog}s===moduleEmpty&&r===sectionPeople&&(i=_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceFriendsFind),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.saveSearchAttemptStats)(i,0,h,o,n,_,c,l,"","",u)}},logSearchAutoBlocks(e,t,o,i,r,s,n){var _=0,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_auto_rows");if(a)for(var c={search_audio_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchAudio,search_people_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchPeople,search_communities_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchGroups,search_video_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchVideo,search_clips_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchClips,search_market_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchMarket,search_classifieds_media:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchClassifieds},l=0;l<a.children.length;++l){for(var d,u=a.children[l],h=null,p=_createForOfIteratorHelperLoose(u.classList);!(d=p()).done;){var f=d.value;if(c.hasOwnProperty(f)){h=c[f];break}}if(h){var g=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.intval)(u.getAttribute("data-block-num"));_=Math.max(_,g);var m=0;r.hasOwnProperty(h)&&(m=r[h]);var w="";s.hasOwnProperty(h)&&(w=s[h]),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.saveSearchAttemptStats)(e,0,!0,t,o,m,0,w,h,"",n,g)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("no_results")||(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.saveSearchAttemptStats)(e,0,!0,t,o,i,0,"",_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.blockNameSearchPosts,"",n,_+1)},getSectionParams(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("filter_form"),o={};for(var i in(o=!t||e&&e!==cur.section||cur.section===sectionQuick?{[paramSection]:e||cur.section}:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.serializeForm)(t)||{})[paramQuery]=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)("search_query"),o)o.hasOwnProperty(i)&&(o[i]&&"0"!=o[i]||delete o[i],"-1"==o[i]&&o[`${i}_custom`]?(o[i]=o[`${i}_custom`],delete o[`${i}_custom`]):o[`${i}_custom`]&&delete o[`${i}_custom`]);return cur.section!==sectionVideo||o[paramSort]||(o[paramSort]="0"),cur.section===sectionPeople&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("photo")&&!o[paramPhoto]&&(o[paramPhoto]="0"),cur.section===sectionPeople&&o[paramInvite]&&delete o.from,cur.section!==sectionCommunities||!cur.filtersShown||o[paramQuery]||o[paramCategory]||(o[paramSkipCatalog]="1",cur.module===moduleGroupsRecommendations&&(o[paramGroupsRecommendationsModel]="1",o[paramFrom]=cur.from,o[paramBlockPosition]=cur.block_position)),o},sameParams(e){if(!cur.params)return!1;for(var t in e)if(e.hasOwnProperty(t)&&e[t]!=cur.params[t])return!1;for(var o in cur.params)if(cur.params.hasOwnProperty(o)&&e[o]!=cur.params[o])return!1;return!0},switchAudioTop(e){return cur.useRec=e,cur.audioTop=e,this.switchSection(sectionAudio)},showMedia:(e,t,o)=>(!o||!(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(o))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)("label",t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)("progress",t)),cur.loadingMedia=!0,searcher.switchSection(e,{updateStats:!0},o)),updResults(){if(cur.customSearchChange)return cur.customSearchChange(),!1;var e=searcher.getSectionParams();if(searcher.sameParams(e)||e[paramSection]===sectionVideo&&!e[paramQuery]&&!nav.objLoc[paramQuery])return!1;cur.onSearchChange&&cur.onSearchChange(e);var t=(cur.section===sectionAuto||cur.section===sectionAudio&&e[paramQuery]&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("audio_lyrics_filter")||cur.section===sectionAudio&&!e[paramQuery]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("audio_lyrics_filter"))&&!e.offset;searcher.sendSearchReq(e,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.gpeByClass)("ui_search","search_query"),"ui_search_fixed")&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)()},onInputChange(e){clearTimeout(cur.requestTimeout),!e||"keydown"===e.type&&13!==e.keyCode?cur.requestTimeout=setTimeout((()=>{searcher.updResults()}),1e3):searcher.updResults()},onKey(){cur.section===sectionQuick&&(clearTimeout(cur.requestTimeout),cur.requestTimeout=setTimeout((()=>{searcher.updResults()}),300))},onEnter(e,t){var o=window.iSearch;o&&o.select&&o.select.isVisible()&&o.select.active>-1||(clearTimeout(cur.requestTimeout),searcher.updResults(),searcher.highlightHotHashtag(t))},checkbox(e,t,o,i){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.checkbox)(e);var r=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.isChecked)(e)?1:0;o&&(r=1-r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(t,r),i||searcher.updResults()},setSection(e){e!==cur.section&&e!==sectionAuto&&e&&(cur.section=e)},applyOptions(options,changeSection){var iSearch=window.iSearch;iSearch.initSelect(),searcher.setSection(options.section),options.reply_names&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(cur.options.reply_names,options.reply_names),delete options.reply_names),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.extend)(cur,options),cur.params=searcher.getSectionParams();var header=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_header");if(options.tabs)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)("search_tabs_wrap",options.tabs),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)(header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)("search_tabs_wrap");else if(options.title){var headerInner=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)("_header_inner",header);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(headerInner,options.title),options.summary&&headerInner.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ce)("span",{className:"page_block_header_count",innerHTML:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.langNumeric)(options.summary,"%s",!0)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)("search_tabs_wrap"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)(header)}if(null!=options.controls&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)("_header_extra",header),options.controls||""),void 0!==options.auto_rows&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_auto_rows")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_auto_rows").innerHTML=options.auto_rows||""),clearTimeout(cur.setLocTO),options.loc)if(changeSection)try{nav.setLoc(options.loc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)(e)}else cur.setLocTO=setTimeout((()=>{if("search"===nav.objLoc[0]||nav.objLoc[0]===sectionCommunities||"brands"===nav.objLoc[0]||nav.objLoc[0].match(/^people($|\/)/)||cur.searchLoc)try{nav.setLoc(options.loc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)(e)}}),100);if(options.htitle&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.stripHTML)(options.htitle))),void 0!==options.q){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)("search_query",(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.stripHTML)(options.q))||"");var resetEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_clear_params");resetEl&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)(resetEl)}if(cur.uiSort&&void 0!==options.sortHide&&(options.sortHide&&cur.uiSort.selectItem(0,!1),cur.uiSort.disable(options.sortHide)),cur.section===sectionAuto&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)("search_menu_auto","search_menu")),options.script)try{eval(options.script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,options.script)}var res=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("results"),sc=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_content"),lighted=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)(sc,"highlight"),noResultsClass=(null==options?void 0:options.real_offset)||"auto"===(null==options?void 0:options.section)?"":"search_empty_result ";res.className=`search_results ${noResultsClass}search_${cur.section}_results${cur.section===sectionStatuses||cur.section===sectionAuto?" wall_module":""}${cur.section===sectionStatuses&&""!==options.summary||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.gpeByClass)("page_block",res)?"":" page_block"} mark_top_verified`,cur.section===sectionAudio&&(res.className+=" audio_w_covers"),lighted&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(sc,"highlight");var moreResults=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_more_results");cur.has_more||moreResults&&moreResults.firstChild?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)("seach_pages"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.show)("ui_search_load_more")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)("ui_search_load_more")},selectHotHashtag(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(e),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_query"),i=((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.data)(o,"opts")||{}).onEnter;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(o,t),i&&i(o,t),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_11__.statlogsValueEvent)("top_hashtag_search",0,"click"),!1},highlightHotHashtag(e){e=e?e.toLowerCase():"";var t=!1,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass)("search_hot_hashtags_item","search_hot_hashtags");return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(o,((o,i)=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(i).toLowerCase()===e?(t=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(i,"search_hot_hashtags_item_active")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)(i,"search_hot_hashtags_item_active")})),t},toggleFilter(e,t,o){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)(e,"search_filter_shut")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(t)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(e,"search_filter_open"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)(e,"search_filter_shut"),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_13__.slideDown)(t,200,(()=>{(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_10__.checkPageBlocks)(),o&&o()}))):(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_13__.slideUp)(t,200,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(e,"search_filter_shut"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)(e,"search_filter_open"),o&&o()}))},appendElements(e){if(e){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.re)(e)}},close:()=>nav.go(cur.search_return_to,{},{back:!0}),toggleMinimizedFilters(e,t,o){var i=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.domNS)(e),r=o?0:200;return void 0===t&&(t=!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(i)),!t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(i)?(cur.filtersShown=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)(e,"ui_rmenu_item_expanded"),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_13__.slideUp)(i,r)):t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(i)&&(cur.filtersShown=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(paramCategory,0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(e,"ui_rmenu_item_expanded"),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_13__.slideDown)(i,r)),!1},onCommunitiesToggle(){"search"==cur.module&&(uiRightMenu.switchMenu((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass1)(`search_menu_${cur.section}`,"search_menu")),searcher.updResults())},showMenuFeaturing(e){var t,o=document.querySelector(e);if(o){o.classList.add("ui_rmenu_item--featuring");var i=()=>this.hideMenuFeaturing(e);o.addEventListener("click",i),null==(t=window.cur.destroy)||t.push((()=>{o.removeEventListener("click",i)}))}},hideMenuFeaturing(e){var t=document.querySelector(e);t&&t.classList.remove("ui_rmenu_item--featuring")},onMarketSwitchSection(e,t){void 0===t&&(t=!1),searcher.removeLogClickHandlers();var o=searcher.getSectionParams("market"),i=document.querySelector("#search_query"),r=document.querySelector(".search_menu_market");return t&&i?(i.value="",delete o["c[q]"]):(o.swt=1,o.tab=1),r&&uiRightMenu&&((0,_web_ecomm_market_MarketSearchBanner_utils_hideFeaturing__WEBPACK_IMPORTED_MODULE_27__.hideFeaturing)().then((()=>{var e=document.querySelector(".MarketSearchBanner");e&&e.remove(),searcher.hideMenuFeaturing(".search_menu_market")})),uiRightMenu.switchMenu(r)),searcher.setSection("market"),searcher.sameParams(o)||searcher.sendSearchReq(o,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.gpeByClass)("ui_search","search_query"),"ui_search_fixed")&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(),!1},subscribe(e,t,o,i,r,s,n){var _,a,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.gpeByClass)("search_row",e);if(cur.unsubscribed=cur.unsubscribed||{},!i&&s&&!cur.unsubscribed[t]){var l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)("global_warning"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)(s),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)("search_group_leave"),(()=>{l.hide(),searcher.subscribe(e,t,o,i,r)}),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)("global_cancel"));return!1}i?(_="al_feed.php",a={act:"subscr",oid:t,hash:o,from:r||"search",ref:cur.module},(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.domData)(e,"trackcode")&&(a.trackcode=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.domData)(e,"trackcode"))):(_="al_fans.php",a={act:"unsub",oid:t,hash:o,from:"search",ref:cur.module});ajax.post(_,a,{onDone(){n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.toggleClass)(c,"touched",!!i):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.toggle)(`search_sub${t}`,!i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.toggle)(`search_unsub${t}`,!!i)),i||(cur.unsubscribed[t]=1)},onFail(e){if(e)return setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_21__.getLang)("global_error"),e).hide,2e3),!0},showProgress(){n?(e.tt&&e.tt.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.addClass)(c,"loading")):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.lockButton)(e)},hideProgress(){n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.removeClass)(c,"loading"):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_19__.unlockButton)(e)}})},onResize(){searcher.scrollCheck()},scrollCheck(){if(!(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.mobile||cur.isSearchLoading||cur.disableAutoMore)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("ui_search_load_more");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(e)){var t=document.documentElement,o=window.innerHeight||t.clientHeight||bodyNode.clientHeight;(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollGetY)()+o+200>e.offsetTop&&searcher.showMore()}else{var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_more_results");i&&searcher.appendElements(i)}}},switchFilter(e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(o))return!1;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(`c[${e}]`)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(`c[${e}]`).value=t),cur.section===sectionVideo&&"quality"===e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(paramHd)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)(paramHd).value=t<0?0:1),searcher.updResults()},showMiniAppTooltip(e){var t=e.dataset.appId,o=e.tt&&e.tt.container?e.tt.container:null;o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.isVisible)(o)&&(o.classList.remove("tt_left"),o.classList.remove("tt_right"),o.classList.remove("GlobalAppsCardTooltipWrapper--up"));var i,r="left",s=-100,n="",_=document.documentElement.clientWidth,a=document.documentElement.clientHeight,c=e.getBoundingClientRect();c.left>_-520?(r="right",i=365):i=-c.width-10,c.top>a-400&&(s=-50,n="GlobalAppsCardTooltipWrapper--up",o&&o.classList.add(n)),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_23__.showTooltip)(e,{url:"al_apps.php",params:{act:"mini_app_card_tooltip",app_id:t},className:`GlobalAppsCardTooltipWrapper ${n}`,shift:[i,s],hasover:!0,ajaxdt:200,showdt:300,hidedt:300,center:!1,dir:r})},openMiniApp(e,t,o){o&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_12__.showWiki)({w:`app${e}`,app_ref:t})}},iSearch={init(e,t){if(!this.inited){var o=this;this.inited=!0,this.input=e,this.cont=e.parentNode.parentNode;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ce)("div",{className:"results_container",innerHTML:'<div class="result_list"></div>'});this.cont.appendChild(i),this.resultList=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.geByClass)("result_list",i)[0],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hide)(this.resultList),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.chrome&&(this.resultList.style.opacity=1),this.resultList.style.width=i.style.width="552px",this.onShowCallback=!!t&&t.onShow,this.initSelect(t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(e,"keyup click mouseup",o.inputUpHandler),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(document,"click",o.documentClick),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(e,"keypress keydown",o.inputDownHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("top_search")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("top_search").onclick=e=>hab.getLoc().indexOf("search")?nav.go("search",e,{search:!0}):(window.searcher&&searcher.close(),!1))}},inputUpHandler(e){var t=window.iSearch;if(t.select){if((t.select.isVisible()&&t.select.active>-1||cur.preventISRequest)&&(delete cur.preventISRequest,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.inArray)(e.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.UP,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.DOWN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.PAGEUP,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.PAGEDOWN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.RETURN])))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e);clearTimeout(cur.requestTimeout);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(t.input);t.currentTerm=o;var i=cur.section;o?cur.requestTimeout=setTimeout((()=>{cur.setISearch=!0,ajax.post("/hints.php?act=a_gsearch_hints",{q:o,section:i},{onDone(e){t.currentTerm===o&&cur.setISearch&&t.showSelectList(o,e),delete cur.setISearch},cache:1})}),300):t.select.hide()}},documentClick(){var e=window.iSearch;e.select&&e.select.hide()},inputDownHandler(e){var t=window.iSearch;if(t.select){if(!t.select||t.select.active<0)return e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.RETURN&&t.select&&(cur.preventISRequest=!0,t.select.hide()),!0;if(e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.SPACE||(e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.RETURN||10===e.keyCode)&&t.select&&t.select.isVisible()){var o,i=t.select.list.childNodes[t.select.active],r=i?i.getAttribute("val"):"";if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(t.lastItems,(function(){this[0]===r&&(o=this)})),!o)return;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(t.input,o[3]+(e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.SPACE?" ":"")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.elfocus)(t.input,t.input.length),e.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.SPACE&&(cur.preventISRequest=!0,t.select.hide(),searcher.updResults()),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)}return e.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.KEY.RETURN&&10!==e.keyCode||!t.select||!t.select.isVisible()||((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.triggerEvent)(document,e.type,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e))}},initSelect(){var e=window._iu,t=window.Select;if(!this.select&&t&&e&&this.resultList){this.guid=e.reg(this);var o=this;this.select=new t(this.resultList,{selectFirst:!1,onItemSelect:this.onItemSelect.bind(this),onShow:()=>((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.isFunction)(o.onShowCallback)&&o.onShowCallback(),e.sel(o.guid)),onHide:e.sel.pbind(!1),cycle:!0}),this.select.hide()}},showSelectList(e,t){this.select&&((t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.isArray)(t)&&t.length?t:[]).length?(this.select.clear(),this.lastItems=t,this.select.content(t),this.select.show(),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_22__.isFunction)(this.onShowCallback)&&this.onShowCallback()):this.select.hide())},onItemSelect(e){var t;if(this.select&&(this.select.hide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.each)(this.lastItems,(function(){this[0]===e&&(t=this)})),t)){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ce)("div",{innerHTML:t[3]});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.val)(this.input,o.innerText||o.textContent),this.input.blur(),searcher.updResults()}},onEvent(e){e.type===(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.opera||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.mozilla?"keypress":"keydown")&&this.select.handleKeyEvent(e)},destroy(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.cleanElems)(this.resultList),clearTimeout(e?e.requestTimeout:cur.requestTimeout),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(this.input,"keyup click mouseup",this.inputUpHandler),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(document,"click",this.documentClick),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(this.input,"keypress keydown",this.inputDownHandler),this.select&&(this.select.destroy(),delete this.select),this.resultList&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.re)(this.resultList.parentNode),delete this.lastItems,this.inited=!1},updateResultsList(e){e?e+="px":e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_18__.ge)("search_query_wrap"),"wide")?"512px":"451px",this.resultList.style.width=e}}},49034:(e,t,o)=>{o.d(t,{slideShow:()=>m,slideHide:()=>w,searchActions:()=>v});o(21466);var i=o(35093),r=o(66890),s=o(86409),n=o(86067),_=o(59121),a=o(40906),c=o(54612),l=o(35429),d=o(95724),u=o(49535),h=o(35676),p=o(15544),f=o(98530),g=o(6593),m=e=>{(0,p.isVisible)(e)||(0,h.slideDown)(e,150)},w=e=>{(0,p.isVisible)(e)&&(0,h.slideUp)(e,150)},v={peopleMessage(e){(0,i.showWriteMessageBox)(window.event||{},e)},peopleAction(e,t,o){ajax.post(t,o,{onDone(t){e.parentNode.replaceChild((0,p.ce)("span",{innerHTML:t}).firstChild,e)}})},ownerAction(e,t,o){var i=e.parentNode;ajax.post(t,o,{onDone(e){i.innerHTML=e}})},groupAction(e,t,o,i,s){ajax.post("al_groups.php",{act:"member_action",action:t,gid:o,mid:i,hash:s,context:"search"},{onDone(t){e.parentNode.replaceChild((0,p.ce)("span",{innerHTML:t}).firstChild,e);var o=_tbLink.loc;o&&(0,r.globalHistoryDestroy)(o)}})},inviteToGroup(e,t,o,i,r){var s=r=>{var s,_;r?(s=(0,n.getLang)("search_cancel_invitation"),_=g.FlatButtonAppearance.SECONDARY):(s=(0,n.getLang)("search_send_invitation"),_=g.FlatButtonAppearance.PRIMARY),e.onclick=()=>{v.inviteToGroup(e,t,o,i,r?1:0)},g.FlatButton.setLabel(e,s),g.FlatButton.setAppearance(e,_)},a=()=>g.FlatButton.lock(e),c=()=>g.FlatButton.unlock(e);return r?ajax.post("/al_page.php",{act:"a_cancel_invite",mid:o,gid:t,hash:i},{onDone(){s(0)},showProgress:a,hideProgress:c}):ajax.post("/al_page.php",{act:"a_invite",mid:o,gid:t,hash:i},{onDone(t,o){t?s(1):((0,_.showMsg)((0,p.gpeByClass)("people_row",e),o,"msg"),(0,p.hide)(e))},showProgress:a,hideProgress:c}),!1},showLyrics(e,t,o){var i=(0,p.ge)(`lyrics${e}`);i?(0,p.isVisible)(i)?(0,p.hide)(i):(0,p.show)(i):(i=(0,p.ce)("div",{id:`lyrics${e}`,className:"audio_lyrics_wrap",innerHTML:'<div class="loading"></div>'}),(0,p.ge)(`audio${e}`).appendChild(i),ajax.post("/al_audio.php",{act:"get_lyrics",lid:t,aid:e,top:o},{onDone(e){i.innerHTML=`<div class="audio_lyrics ta_l">${e}</div>`}}))},toggleBanInGroup(e,t,o,i){(0,c.showBox)("/groupsedit.php",{act:"bl_edit",name:`id${t}`,gid:o},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})},selectCategory(e,t,o){(0,p.ge)("c[category]").value=t,e&&(0,p.hasClass)(e,"_ui_rmenu_subitem")&&uiRightMenu.switchMenu(e);var i=(0,p.ge)("search_query");return(0,p.val)(i)&&((0,p.val)(i,""),i.focus(),(0,u.triggerEvent)(i,"keyup")),f.searcher.toggleMinimizedFilters((0,p.ge)("search_filters_minimized"),!1),f.searcher.updResults(),!1},searchUnchooseGeoPoint(){var e=(0,p.ge)("search_status_map"),t=(0,p.ge)("search_status_map_delete_wrap");(0,p.removeClass)(e,"search_status_map_selected"),(0,p.setStyle)(e,{backgroundImage:""}),t&&t.tt&&t.tt.hide&&t.tt.hide(),(0,p.val)("search_status_map_hidden",""),f.searcher.updResults()},chooseGeoPoint(e,t,o,i){boxQueue.hideLast();var r=Math.pow(10,10),s=200,n=120;window.devicePixelRatio>=2&&(s*=2,n*=2),e=Math.round(e*r)/r,t=Math.round(t*r)/r;var _=(0,p.ge)("search_status_map");(0,p.addClass)(_,"search_status_map_selected"),(0,p.setStyle)(_,{backgroundImage:`url(/maps?lat=${e}&lng=${t}&z=${o}&w=${s}&h=${n})`}),i||((0,p.val)("search_status_map_hidden",`${e},${t},${o}`),f.searcher.updResults())},searchChooseGeoPoint(){var e={act:"a_choose_place_box",search:1},t=(0,p.val)("search_status_map_hidden").match(/(\-?\d{1,3}(?:\.\d+)?)\,(\-?\d{1,3}(?:\.\d+)?)(?:\,(\d+))?/);t&&(e.lat=(0,a.floatval)(t[1]),e.lon=(0,a.floatval)(t[2]),e.zoom=t[3]||8),(0,c.showBox)("/al_places.php",e),cur.chooseGeoPoint=window.searchActions.chooseGeoPoint},searchUrlOnChange(e,t,o){var i=(0,p.ge)("search_status_url"),r=i.name,n=t?"c[domain]":"c[url]";return(0,s.radiobtn)(e,t,"search_status_hint_domain"),(0,p.elfocus)(i),(0,p.val)(i)&&n!==r&&(i.name=n,f.searcher.updResults()),(0,u.cancelEvent)(o)},onChangeCommunityType(e){e=(0,a.positive)(e),(0,p.val)((0,p.ge)("c[type]"),e),m("region_filters"),3===e?(m("events_filter"),(0,p.val)((0,p.ge)("all_events"),(0,s.isChecked)("future")?0:1)):(w("events_filter"),(0,p.val)((0,p.ge)("all_events"),0)),(0,l.checkPageBlocks)(),window.searchActions.updateCommunityThemes(e),f.searcher.updResults()},updateCommunityThemes(e,t){e=(0,a.positive)(e);var o,i=(0,a.positive)((0,p.val)((0,p.ge)("not_safe_search"))),r=[];i?r=cur.communityThemes[e]||[]:(0,d.each)(cur.communityThemes[e]||[],(function(){this[5]||r.push(this)})),t?(o=(0,a.positive)(cur.communityThemesDD.val()),!(0,d.inArray)(o,cur.notSafeThemesIds)&&o||cur.communityThemesDD.clear()):cur.communityThemesDD.clear(),cur.communityThemesDD.setOptions({autocomplete:!1}),cur.communityThemesDD.setData(r),cur.communityThemesDD.setOptions({autocomplete:!0}),e>1?m("cTheme"):w("cTheme")},onChangeCommunityTheme(e){(0,p.val)((0,p.ge)("c[theme]"),e),f.searcher.updResults()},onChangeNotSafe(e,t,o){var i=(0,p.val)((0,p.ge)("c[theme]"));(0,d.inArray)(i,cur.notSafeThemesIds)&&(0,p.val)((0,p.ge)("c[theme]"),""),f.searcher.checkbox(e,t,o,!0),window.searchActions.updateCommunityThemes((0,p.val)((0,p.ge)("c[type]")),!0),f.searcher.updResults()}}},99995:(e,t,o)=>{o.d(t,{hideFeaturing:()=>r});var i=o(89798),r=function(){return(0,i.api)("market.searchFeaturingClose",{})}},14350:(e,t,o)=>{o(75115),o(40851),o(96253),o(20075),o(76142),o(59357),o(21466),o(51876),o(50110);var i=o(19331),r=o(82284),s=o(26271),n=o(87910),_=o(25489),a=o(86067),c=o(87481),l=o(35429),d=o(66890),u=o(50167),h=o(86125),p=o(76567),f=o(49535),g=o(3834),m=o(47612),w=o(15544),v=o(34010),b=o(416),E=o(86409),P=o(54612),C=o(76852),y=o(60615),M=o(95724);function D(e){var t,o;if(null!==(o=t=e)&&"object"==typeof o&&("queue"in t||"key"in t&&"string"==typeof t.key))return e.queue||e.key}var k=o(26330),O=o(93680);function T(e,t){void 0===t&&(t=!1);var o=L();o.push(e),k.default.set("friends_recomm",o),A(t)}function L(e,t,o){void 0===e&&(e=!1),void 0===o&&(o=!1);var i=k.default.get("friends_recomm"),r=Array.isArray(i)?i:[];return t&&(r=r.filter((function(e){return(o?e[1]!==t:e[1]===t)&&(0,M.inArray)(e[0],["show_user_rec","open_user"])}))),e&&(r=r.map((function(e){return e.join("|")}))),r}function B(e){if(e){var t=L(!1,e,!0);t.length?k.default.set("friends_recomm",t):k.default.remove("friends_recomm")}else k.default.remove("friends_recomm");!function(e){if(e){var t=k.default.get("friends_recomm_visited")||{};delete t[e],k.default.set("friends_recomm_visited",t)}else k.default.remove("friends_recomm_visited")}(e)}function A(e){var t,o;void 0===e&&(e=!1),!(null===(t=window.cur)||void 0===t?void 0:t.friendsRecommLogIdle)&&(null===(o=null===window||void 0===window?void 0:window.curNotifier)||void 0===o?void 0:o.idle_manager)&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=function(){clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(A)),clearTimeout(window.cur.friendsRecommLog),e?I():window.cur.friendsRecommLog=window.setTimeout(I,1e4)}function I(){if(!window.cur.friendsRecommProcess){var e=L(!0);e.length&&(window.cur.friendsRecommProcess=!0,B(),O.ajax.post("al_friends.php",{act:"a_recomm_logs",logs:e},{onDone:function(){delete window.cur.friendsRecommProcess},onFail:function(){return function(e){var t=L();t=e.map((function(e){return e.split("|")})).concat(t),k.default.set("friends_recomm",t)}(e),delete window.cur.friendsRecommProcess,!0}}))}}function R(e,t,o){if(!e.viewed&&(0,w.hasClass)(e,"ui_gallery_item")){var i,r=+(0,w.domData)(e,"uid"),s="feed"===window.cur.module&&window.Feed?null===(i=window.Feed)||void 0===i?void 0:i.getModuleRef():window.cur.module,n=function(e){var t,o=(0,w.domData)(e,"code");return o||(t=(0,w.gpeByClass)("ui_gallery",e),o=(0,w.domData)(t,"code")),o||""}(e);T(["show_user_rec",r,Date.now(),t,s,o,n]),e.viewed=!0}}function S(e){var t=e.querySelector(".js-feed_groups_recomm"),o=e.querySelector(".ui_gallery");if(t&&o){var i,r=o.getAttribute("data-code")||"",s=null!==(i=t.__RecommendedGroups)&&void 0!==i?i:void 0;if(s){s.viewBlock(r);var n=(0,m.uiGetGallery)(o);n&&n.getVisibleItems().forEach((function(e){s.onViewGroup(e[0])})),o.visible=!0}else console.error(new Error("RecommendedGroups: missing block instance"),t,o)}else console.error(new Error("RecommendedGroups: missing block container for view"),t,o)}var W=o(95146),U=o(70655),x=(o(59397),Number.isInteger,o(69687)),K=o(91525);(0,x.makeSharedState)("reactions-storage",(function(){return new Map})),(0,x.makeSharedState)("reactions-config",(function(){return{config:void 0}}));var H=function(e,t){return t.length>e},q=function(e){var t=JSON.parse(e);if(null===t||"object"==typeof t||Array.isArray(t)){var o;if(Array.isArray(t))t=(o=t,Object.assign({},o));return t}},N=function(e){var t=H(5,e)?e[5]:void 0;if("string"==typeof t){var o=function(e){var t=e.indexOf(";"),o=e.substr(0,t),i=e.substr(t+1);if("1"===o)return q(i)}(t);if(o)return{counts:o}}},F=o(98530),j=o(6593),V=o(9720),G=o(40906),z=(o(91181),o(56997),o(83946),o(61540)),$=o(18149);const Y={init(e,t){var o,i,r,s=(0,w.ge)("video_live_blacklist_search"),n=(0,w.ge)("video_live_blacklist_wrap"),_=(0,w.domByClass)(n,"olist"),c={};function l(e){var r=e;if((e=(0,M.trim)(e).replace(/\s+/g," ").toLowerCase())!==i){i=e;var s=e?o.search(e):t.list,n="";if(s.length)for(var l,d=new RegExp(e,"i"),u=0;u<s.length;u++)l=s[u],n+=(0,M.getTemplate)("video_live_blacklist_item",{id:l.id,href:l.href,photo:l.photo,name:e?l.name.replace(d,"<em>$&</em>"):l.name,class:c[l.id]?" olist_item_wrap_on":""});else n=(0,M.getTemplate)("video_live_blacklist_empty",{text:(0,a.langStr)((0,a.getLang)("global_search_not_found"),"search","<b>"+(0,M.clean)(r)+"</b>")});(0,w.val)(_,n)}}e.setOptions({bodyStyle:"padding:0;",onDestroy:function(){uiSearch.destroy(s),r&&r.destroy(),e=o=r=n=s=null}}),t.list.length&&(e.removeButtons().addButton((0,a.getLang)("global_save"),(function(o){ajax.post("al_video.php?act=save_live_blacklist",{exclude:Object.keys(c).join(","),hash:t.save_hash},{onDone:function(t){e.hide(),t&&(0,h.showDoneBox)(t)},showProgress:()=>(0,E.lockButton)(o),hideProgress:()=>(0,E.unlockButton)(o)})})).addButton((0,a.getLang)("global_cancel"),null,"no"),r=new uiScroll(n),l(""),n.onclick=function(e){var t=(0,w.domClosest)("olist_item_wrap",e.target);if(!t)return;(0,f.cancelEvent)(e);var o=(0,w.domData)(t,"id");(0,w.toggleClass)(t,"olist_item_wrap_on")?c[o]=1:delete c[o]},s&&(o=new $.vkIndexer(t.list,(function(e){return e.name+" https://"+(0,z.getHostName)()+e.href})),uiSearch.init(s,{onChange:l}),uiSearch.focus(s)))}};var Q,X=o(30104),J=function(e){(0,X.triggerAnimationClass)(e,"post_highlight_updated",3e3)},Z=function(e){var t,o;if(!(e instanceof HTMLElement))return{};var i=(0,M.indexOf)((0,w.domPN)(e).children,e),r=e.firstElementChild;if(!(r instanceof HTMLElement))return{};for(;r&&r.id.startsWith("moat");)r=(0,w.domNS)(r);if(!(r instanceof HTMLElement))return{};var s,n,_,a=/^post(-?\d+_\d+)$/,c={};if("ads_feed_placeholder"===r.id)return c;var l=window.cur;c={module:l.module,index:i},"feed"==l.module&&("search"==l.section?(c.module="feed_search",c.q=l.q):"news"==l.section?c.module=l.subsection?"feed_news_"+l.subsection:"feed_news":"recommended"==l.section?c.module=l.subsection?"feed_recommended_"+l.subsection:"feed_recommended":"friends"==l.section?c.module=l.subsection?"feed_friends_"+l.subsection:"feed_friends":"groups"==l.section?c.module=l.subsection?"feed_groups_"+l.subsection:"feed_groups":"videos"==l.section?c.module=l.subsection?"feed_videos_"+l.subsection:"feed_videos":"photos"==l.section?c.module=l.subsection?"feed_photos_"+l.subsection:"feed_photos":"podcasts"==l.section?c.module=l.subsection?"feed_podcasts_"+l.subsection:"feed_podcasts":"list"==l.section?c.module=l.subsection?"feed_list_"+l.subsection:"feed_list":c.module="feed_other");var d=r.getAttribute("data-ad-view");d&&(c["ad_"+d]=1);var u=r.getAttribute("post_view_hash");if(u&&(c.hash=u),"block_"===r.id.substr(0,6)){c[r.id]=1,c.block=r.id.substr(6);var h=(0,w.attr)(r,"data-contain");h&&h.split(",").forEach((function(e){var t=e.split(":");c[t[0]]=(0,M.intval)(t[1])||1}))}else if(n=r.id.match(a))c[n[1]]=1;else if(n=r.id.match(/^post(adsite.*)$/))c[n[1]]=1;else if(n=(s=r.className).match(/feed_reposts_wrap(-?\d+_\d+)/)){if(_=(0,w.domFC)(r),(0,w.hasClass)((0,w.domFC)(_),"post_copy")&&(c[n[1]]=-1),(n=(0,w.domFC)(_).id.match(a))&&(c[n[1]]=1),(0,w.isVisible)(_=(0,w.domNS)(_)))for(_=(0,w.domFC)(_);_;_=(0,w.domNS)(_))(n=_.id.match(a))&&(c[n[1]]=1)}else if(n=s.match(/feed_repost(-?\d+_\d+)/)){if(!(_=(0,w.domFC)(r)))return c;(0,w.hasClass)(_,"post_copy")&&(c[n[1]]=-1),(n=_.id.match(a))&&(c[n[1]]=1)}else{var p=r.id;if((0,w.hasClass)(r,"post_photos")){var f=null===(o=null===(t=null==(_=(0,w.geByClass1)("post_image",r,"a"))?void 0:_.querySelector)||void 0===t?void 0:t.call(_,"[data-post-id]"))||void 0===o?void 0:o.getAttribute("data-post-id");f&&(n=f.match(/^(-?\d+_p?\d+)$/))&&(p=n[1])}c[p]=1}return c},ee=function(e){var t=e&&(0,w.domFC)(e);return t&&t.hasAttribute("data-ad-video-autoplay")},te=function(e){var t=e&&(0,w.domFC)(e);return t&&t.hasAttribute("data-ad-views-long-only")},oe=((e,t)=>{var o,i=!1;return function(){return!0===i||(o=e(...arguments),i=t(o)),o}})((function(){return(0,w.ge)("page_header").offsetHeight}),(e=>!!e));!function(e){e.YoulaRecommendationsCarousel="block_youla-recommendations-carousel",e.AliExpressRecommendationsCarousel="block_aliexpress-recommendations-carousel",e.PhotoRecognize="tags_suggestions",e.RecommendedNarratives="recommended_narratives",e.VideosForYou="videos_for_you",e.VideoPostcard="video_postcard"}(Q||(Q={}));var ie,re,se={tracking:[],viewed:{}},ne=(e,t)=>{var o=se.tracking,i=se.viewed;if(0===o.length)return[];var r=[];return(0,M.each)(o,(function(o,s){var n=(0,w.domFC)(s),_=n.id;if(n&&_){var a=(0,w.domData)(n,"ad-block-uid"),c=""+_;if(a&&(c+="_"+a),!i[c]&&document.body.contains(s))if(function(e,t,o,i){var r=oe(),s=o+r,n=o+i,_=e.offsetHeight,a=e.offsetTop+r,c=a+_;return(c>s&&a<n?(Math.min(n,c)-Math.max(s,a))/_:0)>=t}(s,.5,e,t)){var l=Date.now();s.longViewStartedAt?l-s.longViewStartedAt>=1e3&&(i[c]=!0,r.push((0,M.extend)({},Z(s),{long:1}))):s.longViewStartedAt=Date.now()}else s.longViewStartedAt=null}})),r},_e=e=>!!e&&(!!e.longViewTracking||!e.longViewRegistered&&(e.longViewRegistered=!0,e.longViewTracking=ee(e)||function(e){var t=e&&(0,w.domFC)(e);return t&&(t.hasAttribute("data-ad-stat-impression_long")||t.hasAttribute("data-ad-disabled-stat-impression_long"))}(e)||te(e),!!e.longViewTracking&&(se.tracking.push(e),!0))),ae="PhotoCarouselItem--noSize",ce="PhotoCarouselImage",le="PhotoCarouselItem__stub",de="PhotoCarousel__arrowWrapper--hidden",ue=function(){function e(e,t,o){var i=this;this.activeItemIdx=0,this.onLeftArrowClick=function(e){var t;i.isLeftBtnDisabled?e.stopPropagation():((null===(t=i.options)||void 0===t?void 0:t.onPrevClick)&&i.options.onPrevClick(e),i.prev())},this.onRightArrowClick=function(e){var t,o;i.isRightBtnDisabled?e.stopPropagation():((null===(t=i.options)||void 0===t?void 0:t.onNextClick)&&(null===(o=i.options)||void 0===o||o.onNextClick(e)),i.next())},this.post=e,this.options=o,this.items=t;var r=e.querySelector(".PhotoCarousel"),s=e.querySelector(".PhotoCarousel__arrowWrapper--left"),n=e.querySelector(".PhotoCarousel__arrowWrapper--right"),_=e.querySelector(".PhotoCarousel__items");if(!r||!_)throw new Error("PhotoCarousel: incorrect arguments");var a=(0,U.__read)((0,w.getSize)(_),1)[0],c=(0,U.__read)((0,w.getSize)(r),1)[0];this.carousel=r,this.leftArrowBtn=s,this.rightArrowBtn=n,this.isLeftBtnDisabled=!s||s.classList.contains(de),this.isRightBtnDisabled=!n||n.classList.contains(de),this.photoList=_,this.photoListWidth=a,this.carouselWidth=c,this.activeItemIdx=this.getActiveItemIdxFromDOM(),this.initListeners()}return e.prototype.destroy=function(){this.deInitListeners()},e.prototype.initListeners=function(){this.leftArrowBtn&&this.leftArrowBtn.addEventListener("click",this.onLeftArrowClick),this.rightArrowBtn&&this.rightArrowBtn.addEventListener("click",this.onRightArrowClick)},e.prototype.deInitListeners=function(){this.leftArrowBtn&&this.leftArrowBtn.removeEventListener("click",this.onLeftArrowClick),this.rightArrowBtn&&this.rightArrowBtn.removeEventListener("click",this.onRightArrowClick)},e.prototype.next=function(){this.move(this.getActiveIdx()+1)},e.prototype.prev=function(){this.move(this.getActiveIdx()-1)},e.prototype.getActive=function(){return this.items[this.activeItemIdx]},e.prototype.getActiveIdx=function(){return this.activeItemIdx},e.prototype.getActiveItemIdxFromDOM=function(){return Number(this.carousel.dataset.idx)},e.prototype.move=function(e){var t,o=this.getActiveIdx(),i=this.getActive(),r=this.items[e];if(r){var s=r.getEl();if(this.rightArrowBtn&&this.leftArrowBtn){var n=r.getPhotoRawId(),_=(0,U.__read)((0,w.getSize)(s),1)[0],a=s.offsetLeft,c=Math.round(this.photoListWidth-this.carouselWidth),l=a+_/2-this.carouselWidth/2;if(e>o)l=Math.min(l,c);else{if(!(e<o))return;l=Math.max(l,0)}l=Math.round(l),this.photoList.style.transform="translateX(-"+l+"px)";var d=(this.carouselWidth-_-12)/2,u=this.carouselWidth-_-20-6;l?(this.toggleLeftBtnDisabled(!1),this.leftArrowBtn.style.width=l===c?u+"px":d+"px"):this.toggleLeftBtnDisabled(!0),l===c?this.toggleRightBtnDisabled(!0):(this.toggleRightBtnDisabled(!1),this.rightArrowBtn.style.width=l?d+"px":u+"px"),i.setActive(!1),r.setActive(),this.activeItemIdx=e,this.items.slice(e,e+4).forEach((function(e){return e.init()})),this.carousel.setAttribute("data-idx",String(e)),this.post.setAttribute("data-photo-raw-id",String(n)),(null===(t=this.options)||void 0===t?void 0:t.onChange)&&this.options.onChange()}}},e.prototype.toggleLeftBtnDisabled=function(e){void 0===e&&(e=!0),this.leftArrowBtn&&(e?(this.leftArrowBtn.classList.add(de),this.isLeftBtnDisabled=!0):(this.leftArrowBtn.classList.remove(de),this.isLeftBtnDisabled=!1))},e.prototype.toggleRightBtnDisabled=function(e){void 0===e&&(e=!0),this.rightArrowBtn&&(e?(this.rightArrowBtn.classList.add(de),this.isRightBtnDisabled=!0):(this.rightArrowBtn.classList.remove(de),this.isRightBtnDisabled=!1))},e}(),he=o(20820),pe=function(){function e(e){this.item=e;var t=e.querySelector(".PhotoCarouselImage"),o=e.dataset.photoViewOptions||"",i=e.dataset.photoContext,r=e.dataset.photoRawId,s=o&&(0,he.parseJSON)(o);if(!(s&&r&&i&&t))throw new Error("PhotoCarouselBlockItem: incorrect arguments");var n=(0,U.__read)(r.split("_"),2),_=n[0],a=n[1];this.ownerId=Number(_),this.photoId=Number(a),this.photoRawId=r,this.photoContext=i,this.photoViewOptions=s,this.photo=t,this.isActive=e.classList.contains("PhotoCarouselItem--active")}return e.prototype.setActive=function(e){void 0===e&&(e=!0),this.isActive=e,this.item.classList.toggle("PhotoCarouselItem--active",e)},e.prototype.init=function(){var e=this.item.getAttribute("data-photo-url");if(e){if(this.item.classList.contains(ae)){var t=this.item.querySelector(".PhotoCarouselItem__stub");t&&(t.src=e)}else{var o=this.item.querySelector(".PhotoCarouselImage");if(!o)return;o.style.backgroundImage="url('"+e+"')"}this.item.removeAttribute("data-photo-url")}},e.prototype.getPhotoRawId=function(){return this.photoRawId},e.prototype.getOwnerId=function(){return this.ownerId},e.prototype.getEl=function(){return this.item},e}(),fe=o(82452),ge=o(42041),me=function(e){function t(t,o){var i=e.call(this,t)||this;i.onPhotoClick=function(e){var t;e.ctrlKey||e.metaKey||(i.showPhoto(e),(null===(t=i.options)||void 0===t?void 0:t.sendAnalytic)&&i.options.sendAnalytic("open_photo"))},i.onShareClick=function(e){var t;if(i.objectRawId){var o=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;o&&(o("click_to_sharing",e),window.cur.sbOnShare=function(){o("repost",e)}),ge.Likes.share(i.objectRawId,i.shareOptions),(0,f.cancelEvent)(e)}},i.onCommentsClick=function(e){var t,o=i.photoViewOptions||{};o.commentFocusInit=!0,i.showPhoto(e,o);var r=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;r&&r("click_to_comment",e)},i.onLikeClick=function(e){var t;if(i.likeBtn&&i.objectRawId&&i.likeHash){var o=i.isLiked()?"unlike":"like",r=null===(t=i.options)||void 0===t?void 0:t.sendAnalytic;r&&r(o,e),ge.Likes.toggle(i.likeBtn,e,i.objectRawId,i.likeHash)}},i.isLiked=function(){return i.likeBtn&&i.likeBtn.classList.contains("active")},i.options=o,i.shareBtn=t.querySelector("._share"),i.commentsBtn=t.querySelector("._comment"),i.likeBtn=t.querySelector("._like"),i.objectRawId=t.dataset.objectRawId,i.likeHash=t.dataset.likeHash;var r=t.dataset.shareOptions||"";return i.shareOptions=r&&(0,fe.parseJSON)(r),i.initListeners(),i}return(0,U.__extends)(t,e),t.prototype.destroy=function(){this.deInitListeners()},t.prototype.initListeners=function(){this.shareBtn&&this.shareBtn.addEventListener("click",this.onShareClick),this.commentsBtn&&this.commentsBtn.addEventListener("click",this.onCommentsClick),this.likeBtn&&this.likeBtn.addEventListener("click",this.onLikeClick),this.photo.addEventListener("click",this.onPhotoClick)},t.prototype.deInitListeners=function(){this.shareBtn&&this.shareBtn.removeEventListener("click",this.onShareClick),this.commentsBtn&&this.commentsBtn.removeEventListener("click",this.onCommentsClick),this.likeBtn&&this.likeBtn.removeEventListener("click",this.onLikeClick),this.photo.removeEventListener("click",this.onPhotoClick)},t.prototype.showPhoto=function(e,t){void 0===t&&(t=this.photoViewOptions),(0,u.showPhoto)(this.photoRawId,this.photoContext,t,e),(0,f.cancelEvent)(e)},t}(pe),we=function(){function e(e,t){var o,i=this;this.isDestroyed=!1,this.destroy=function(){i.isDestroyed||(i.deInitListener(),i.carousel.destroy(),i.items.forEach((function(e){return e.destroy()})),i.isDestroyed=!0)},this.onPostClick=function(e){var t,o=e.target;(null===(t=i.blockOptions)||void 0===t?void 0:t.sendAnalytic)&&(o.classList.contains("post_img")||o.classList.contains("author")||o.classList.contains("mem_link")||o.classList.contains("PhotoCarouselBlockItem__avatar")?i.blockOptions.sendAnalytic("open_user",i.post,e):o.classList.contains(ce)||o.classList.contains(le)||o.classList.contains("page_post_thumb_wrap")?i.blockOptions.sendAnalytic("open_photo",i.post,e):o.classList.contains("PhotoCarousel__hidePost")&&i.blockOptions.sendAnalytic("hide",i.post,e))},this.post=e,this.blockOptions=t;var r=this.getCarouselOptions();this.items=this.createItems(e),this.carousel=new ue(e,this.items,r),this.initListeners(),null===(o=window.cur.destroy)||void 0===o||o.push(this.destroy)}return e.prototype.initListeners=function(){this.post.addEventListener("click",this.onPostClick)},e.prototype.deInitListener=function(){this.post.removeEventListener("click",this.onPostClick)},e.prototype.createItems=function(e){var t,o=this,i=Array.from(e.querySelectorAll(".PhotoCarouselItem")),r={};return(null===(t=this.blockOptions)||void 0===t?void 0:t.sendAnalytic)&&(r.sendAnalytic=function(e,t){var i,r;(null===(i=o.blockOptions)||void 0===i?void 0:i.sendAnalytic)&&(null===(r=o.blockOptions)||void 0===r||r.sendAnalytic(e,o.post,t))}),i.map((function(e){return new me(e,r)}))},e.prototype.getCarouselOptions=function(){var e,t=this,o=null===(e=this.blockOptions)||void 0===e?void 0:e.sendAnalytic;return{onPrevClick:function(e){o&&o("click_previous",t.post,e)},onNextClick:function(e){o&&o("click_next",t.post,e)}}},e}();!function(e){e[e.ME=1]="ME",e[e.FRIEND=2]="FRIEND",e[e.ALL=3]="ALL"}(ie||(ie={})),function(e){e[e.Initial=0]="Initial",e[e.Confirmed=1]="Confirmed",e[e.Declined=2]="Declined"}(re||(re={}));var ve=function(){function e(e,t){this.tagEl=e,this.tagArea=t;var o=e.getAttribute("data-item");if(!o)throw new Error("Tag: incorrect json data");var i=JSON.parse(o);this.id=Number(i.id),this.userId=i.userId,this.name=i.name,this.nameGenitive=i.nameGenitive,this.ownerNameGenitive=i.ownerNameGenitive,this.placerNameGenitive=i.placerNameGenitive,this.nameAccusative=i.nameAccusative,this.isSuggested=Boolean(i.isSuggested),this.sex=Number(i.sex),this.styles={top:i.top,left:i.left,width:i.width,height:i.height};var r=re.Initial;e.classList.contains("PhotoTag--confirm")?r=re.Confirmed:e.classList.contains("PhotoTag--decline")&&(r=re.Declined),this.state=r;var s="tag_cutout"+t.getPhotoRawId()+"_"+i.userId,n=document.getElementById(s);if(!n)throw new Error("Tag: incorrect data");this.cutoutEl=n}return e.prototype.decline=function(){this.tagEl.classList.remove("PhotoTag--confirm"),this.tagEl.classList.add("PhotoTag--decline"),this.cutoutEl.classList.remove("PhotoTagCutout--transparency"),this.state=re.Declined},e.prototype.confirm=function(){this.tagEl.classList.remove("PhotoTag--decline"),this.tagEl.classList.add("PhotoTag--confirm"),this.cutoutEl.classList.add("PhotoTagCutout--transparency"),this.state=re.Confirmed},e.prototype.reset=function(){this.tagEl.classList.remove("PhotoTag--decline"),this.tagEl.classList.remove("PhotoTag--confirm"),this.cutoutEl.classList.remove("PhotoTagCutout--transparency"),this.state=re.Initial},e.prototype.getFullRawId=function(){return this.tagArea.getPhotoRawId()+"_"+this.getId()},e.prototype.getId=function(){return this.id},e.prototype.getUserId=function(){return this.userId},e.prototype.getUserName=function(){return this.name},e.prototype.getUserNameGenitive=function(){return this.nameGenitive},e.prototype.getUserNameAccusative=function(){return this.nameAccusative},e.prototype.getOwnerNameGenitive=function(){return this.ownerNameGenitive},e.prototype.getPlacerNameGenitive=function(){return this.placerNameGenitive},e.prototype.isConfirmed=function(){return this.state===re.Confirmed},e.prototype.getSex=function(){return this.sex},e}(),be="ph";function Ee(e){void 0===e&&(e=1);try{var t=function(){var e=document.getElementById("l_ph");if(!e)throw new Error("There is not photo left menu item");var t=e.querySelector(".left_count");return t?(0,M.intval)(t.textContent):0}();(0,d.handlePageCount)(be,Math.max(t-e,0))}catch(e){console.error(e),(0,K.logError)(e)}}var Pe,Ce=function(){function e(e,t,o){var r=this;this.confirmTag=function(e,t,o){o&&(0,E.lockButton)(o);var s=!(0,i.partConfigEnabled)("recognize_mock_turn_off");return new Promise((function(i,n){window.ajax.post("al_photos.php",{act:"confirm_tag",photo:t.getPhotoRawId(),tag:e.getId(),hash:r.tagHash},{onDone:function(){r.setConfirmedTags([e]),r.decrementLeftMenuCounterIfNeeded([e]),i()},onFail:function(){return s?(r.setConfirmedTags([e]),i(),!0):((0,h.showDoneBox)((0,a.getLang)("global_unknown_error")),n(),!0)},hideProgress:function(){o&&(0,E.unlockButton)(o)}})}))},this.declineTag=function(e,t,o){return new Promise((function(s,n){o&&(0,E.lockButton)(o);var _=!(0,i.partConfigEnabled)("recognize_mock_turn_off");window.ajax.post("al_photos.php",{act:"delete_tag",photo:t.getPhotoRawId(),tag:e.getId(),hash:r.tagHash},{onDone:function(){r.setDeclinedTags([e]),r.decrementLeftMenuCounterIfNeeded([e]),s()},onFail:function(){return _?(r.setDeclinedTags([e]),s(),!0):((0,h.showDoneBox)((0,a.getLang)("global_unknown_error")),n(),!0)},hideProgress:function(){o&&(0,E.unlockButton)(o)}})}))},this.confirmSuggestedTags=function(e,t,o){return r.showConfirmAlertBoxIfNeeded(e).then((function(){o&&(0,E.lockButton)(o);var t=!(0,i.partConfigEnabled)("recognize_mock_turn_off");return new Promise((function(i,s){window.ajax.post("al_photos.php",{act:"confirm_suggested_tags",tag_raw_ids:r.getFullRawTagIdsStr(e),track_code:r.trackCode,hash:r.tagHash},{onDone:function(){r.setConfirmedTags(e),r.decrementLeftMenuCounterIfNeeded(e),i()},onFail:function(){return t?(r.setConfirmedTags(e),i(),!0):((0,h.showDoneBox)((0,a.getLang)("global_unknown_error")),s(),!0)},hideProgress:function(){o&&(0,E.unlockButton)(o)}})}))}))},this.declineSuggestedTags=function(e,t,o){return new Promise((function(t,s){o&&(0,E.lockButton)(o);var n=!(0,i.partConfigEnabled)("recognize_mock_turn_off");window.ajax.post("al_photos.php",{act:"decline_suggested_tags",tag_raw_ids:r.getFullRawTagIdsStr(e),track_code:r.trackCode,hash:r.tagHash},{onDone:function(){r.setDeclinedTags(e),r.decrementLeftMenuCounterIfNeeded(e),t()},onFail:function(){return n?(r.setDeclinedTags(e),t(),!0):((0,h.showDoneBox)((0,a.getLang)("global_unknown_error")),s(),!0)},hideProgress:function(){o&&(0,E.unlockButton)(o)}})}))};var s=e.getEl().querySelector(".PhotoTagArea");if(!s)throw new Error("error: there is not tag area el");if(!t)throw new Error("error: there is not tag hash");var n=Array.from(e.getEl().querySelectorAll(".PhotoTag"));this.trackCode=o,this.tagArea=s,this.tagHash=t,this.photoEntity=e,this.tags=n.map((function(e){return new ve(e,r)})),this.tagsMap=this.tags.reduce((function(e,t){return e[t.getId()]=t,e}),{})}return e.prototype.showConfirmAlertBoxIfNeeded=function(e){var t=this,o=e[0];return new Promise((function(e,i){if(window.cur.pvNeedShowAlertForOneSuggest&&o.getUserId()!==window.vk.id)var r=(0,a.getLang)("photo_recognition_one_tag_alert"),s=(0,a.langSex)(o.getSex(),(0,a.getLang)("photo_recognition_one_tag_alert_text","raw")).replace("{name}",o.getUserName()),n=(0,P.showFastBox)(r,s,(0,a.getLang)("photo_recognition_one_friend_submit_btn"),(function(){t.hideHint(),n.hide(),e()}),(0,a.getLang)("global_cancel"),(function(){n.hide(),i()}));else e()}))},e.prototype.hideHint=function(){window.cur.pvNeedShowAlertForOneSuggest=!1;var e=window.cur.pvOneSuggestHintId,t=window.cur.pvOneSuggestHintHash;e&&t&&window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:e,hash:t},{onDone:function(){},onFail:function(){return console.error("something wrong with help hint"),!0}})},e.prototype.decrementLeftMenuCounterIfNeeded=function(e){e.forEach((function(e){e.getUserId()===window.vk.id&&Ee()}))},e.prototype.getFullRawTagIdsStr=function(e){return void 0===e&&(e=this.tags),e.reduce((function(e,t,o){return e+(0===o?"":",")+t.getFullRawId()}),"")},e.prototype.setConfirmedTagsByIds=function(e){var t=this,o=e.reduce((function(e,o){return t.tagsMap[o]&&e.push(t.tagsMap[o]),e}),[]);return!!o.length&&(this.setConfirmedTags(o),!0)},e.prototype.setConfirmedTags=function(e){var t=this;(e=e.filter((function(e){return t.tagsMap[e.getId()]}))).length&&(e.forEach((function(e){return e.confirm()})),this.tagArea.classList.add("PhotoTagArea--fade"))},e.prototype.setDeclinedTags=function(e){e.forEach((function(e){return e.decline()}))},e.prototype.setDeclinedTagsByIds=function(e){var t=this,o=e.reduce((function(e,o){return t.tagsMap[o]&&e.push(t.tagsMap[o]),e}),[]);return!!o.length&&(this.setDeclinedTags(o),!0)},e.prototype.reset=function(){this.tagArea.classList.remove("PhotoTagArea--fade"),this.tags.forEach((function(e){return e.reset()}))},e.prototype.getPhotoRawId=function(){return this.photoEntity.getPhotoRawId()},e.prototype.getTags=function(){return this.tags},e.prototype.getConfirmedTags=function(){return this.tags.filter((function(e){return e.isConfirmed()}))},e.prototype.setSizes=function(e,t){this.tagArea.style.width=e+"px",this.tagArea.style.height=t+"px"},e.prototype.show=function(){this.tagArea.classList.remove("PhotoTagArea--hide")},e.calculateTagAreaSizes=function(e,t,o){var i,r,s=e.offsetWidth,n=e.offsetHeight,_=t/o,a=!0;return s/n>_&&(a=!1),a?(i=Math.round(Math.min(t,s)),r=Math.round(i/_)):(r=Math.round(Math.min(o,n)),i=Math.round(r*_)),[i,r]},e}(),ye=o(91789),Me=o(79957);function De(e,t,o){void 0===t&&(t=""),void 0===o&&(o={});var i=(0,U.__assign)({event_type:e,track_code:t},o);(0,Me.statlogsValueEvent)("photo_recognition_stat",i)}!function(e){e[e.CONFIRMED=0]="CONFIRMED",e[e.DECLINED=1]="DECLINED",e[e.DELETED=2]="DELETED"}(Pe||(Pe={}));var ke,Oe=function(e){function t(t,o){var i=e.call(this,t)||this;i.isLoading=!1,i.isSkipped=!1,i.onShowAllClick=function(e){i.showPhoto(e),i.sendAnalytic("show_tags")},i.onPhotoClick=function(e){e.ctrlKey||e.metaKey||(i.showPhoto(e),(0,f.cancelEvent)(e))},i.onConfirmClick=function(){if(!i.isLoading){var e=i.getTags();i.isLoading=!0,i.tagArea.confirmSuggestedTags(e,i,i.confirmBtn).then((function(){i.updatePhotoviewCache(!0),i.incrementConfirmedCount(e.length),i.showResultPanel(Pe.CONFIRMED),i.block.nextWithDelay()}),(function(e){e&&(0,K.logError)(e)})).finally((function(){i.isLoading=!1}))}},i.onDeclineClick=function(){i.isLoading||(i.isLoading=!0,i.tagArea.declineSuggestedTags(i.getTags(),i,i.declineBtn).then((function(){i.updatePhotoviewCache(!0),i.showResultPanel(Pe.DECLINED),i.block.nextWithDelay()})).finally((function(){i.isLoading=!1})))},i.onCancelClick=function(){i.cancelBtn&&(i.reset(),i.showSuggestPanel())},i.onNextClick=function(){i.skipTags(),i.block.next()};var r=t.dataset.tagHash||"";return i.block=o,i.type=Number(t.dataset.recognizeType),i.title=t.dataset.title,i.trackCode=t.dataset.trackCode||"",i.skipHash=t.dataset.skipHash||"",i.confirmBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--confirm"),i.declineBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--decline"),i.showAllBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--showTags"),i.nextBtn=t.querySelector(".PhotoRecognizeBlockItem__btn--next"),i.description=t.querySelector(".PhotoRecognizeBlockItem__description"),i.tagArea=new Ce(i,r,i.trackCode),i.initListeners(),i}return(0,U.__extends)(t,e),t.prototype.destroy=function(){this.deInitListeners()},t.prototype.skipTags=function(){this.isSkipped||(this.isSkipped=!0,window.ajax.post("al_photos.php",{act:"skip_suggested_tags",tag_raw_ids:this.tagArea.getFullRawTagIdsStr(),photo_raw_id:this.getPhotoRawId(),track_code:this.trackCode,hash:this.skipHash},{onDone:function(){},onFail:function(e){return!!(0,i.partConfigEnabled)("recognize_mock_turn_off")&&e&&(0,K.logError)(e),!0}}))},t.prototype.initListeners=function(){var e,t,o,i,r;null===(e=this.confirmBtn)||void 0===e||e.addEventListener("click",this.onConfirmClick),null===(t=this.declineBtn)||void 0===t||t.addEventListener("click",this.onDeclineClick),null===(o=this.cancelBtn)||void 0===o||o.addEventListener("click",this.onDeclineClick),null===(i=this.showAllBtn)||void 0===i||i.addEventListener("click",this.onShowAllClick),null===(r=this.nextBtn)||void 0===r||r.addEventListener("click",this.onNextClick),this.photo.addEventListener("click",this.onPhotoClick)},t.prototype.deInitListeners=function(){var e,t,o,i,r;null===(e=this.confirmBtn)||void 0===e||e.removeEventListener("click",this.onConfirmClick),null===(t=this.declineBtn)||void 0===t||t.removeEventListener("click",this.onDeclineClick),null===(o=this.showAllBtn)||void 0===o||o.removeEventListener("click",this.onShowAllClick),null===(i=this.nextBtn)||void 0===i||i.removeEventListener("click",this.onNextClick),null===(r=this.cancelBtn)||void 0===r||r.removeEventListener("click",this.onCancelClick),this.photo.removeEventListener("click",this.onPhotoClick)},t.prototype.showPhoto=function(e){(0,u.showPhoto)(this.photoRawId,this.photoContext,this.photoViewOptions,e),this.updatePhotoviewCache()},t.prototype.updatePhotoviewCache=function(e){void 0===e&&(e=!1),this.photoViewOptions.noCache=e,e&&(0,ye.dropPhotoCacheData)()},t.prototype.showResultPanel=function(e){var t;if(this.description){var o=this.getResultText(e);this.resultPanel||this.createResultPanel();var i=null===(t=this.resultPanel)||void 0===t?void 0:t.querySelector(".PhotoRecognizeBlockItem__resultMessage");if(!i||!this.resultPanel)throw new Error("PhotoRecognizeBlockItem: can not get text element");this.resultPanel.classList.toggle("PhotoRecognizeBlockItem__resultPanel--confirmed",e===Pe.CONFIRMED),i.innerHTML=o,(0,w.hide)(this.description),(0,w.show)(this.resultPanel)}},t.prototype.showSuggestPanel=function(){(0,w.hide)(this.resultPanel),(0,w.show)(this.description)},t.prototype.getResultText=function(e){var t=this.getOwnerId(),o=this.getConfirmedTags(),i=this.getTags()[0],r=i.getUserId(),s=i.getOwnerNameGenitive(),n=i.getUserNameAccusative(),_="";switch(e){case Pe.CONFIRMED:this.type===ie.ME?_=t===r?(0,a.getLang)("photo_recognition_confirm_me_on_my_photo"):(_=t>0?(0,a.getLang)("photo_recognition_confirm_myself_on_photo"):(0,a.getLang)("photo_recognition_confirm_myself_on_photo_group")).replace("{name}",s):this.type===ie.FRIEND?_=t===r?(0,a.getLang)("photo_recognition_confirm_on_photo").replace("{name}",s):(_=(_=t>0?(0,a.getLang)("photo_recognition_confirm_friend_on_photo"):(0,a.getLang)("photo_recognition_confirm_friend_on_photo_group")).replace("{name1}",n)).replace("{name2}",s):this.type===ie.ALL&&(_=(0,a.getLang)("photo_recognition_confirm_n_friends_on_photo",o.length));break;case Pe.DECLINED:_=this.type===ie.ALL?o.length?(0,a.getLang)("photo_recognition_confirm_n_friends_on_photo",o.length):(0,a.getLang)("photo_recognition_decline_n_friends_on_photo",o.length):(_=t>0?(0,a.getLang)("photo_recognition_decline_on_photo"):(0,a.getLang)("photo_recognition_decline_on_photo_group")).replace("{name}",s);break;default:_=(0,a.getLang)("photo_recognition_deleted_tag")}return _},t.prototype.createResultPanel=function(){this.resultPanel=document.createElement("div"),this.resultPanel.classList.add("PhotoRecognizeBlockItem__resultPanel");var e=document.createElement("span");e.classList.add("PhotoRecognizeBlockItem__resultMessage"),this.resultPanel.appendChild(e);var t=this.item.querySelector(".PhotoRecognizeBlockItem__footerWrapper");t&&t.appendChild(this.resultPanel)},t.prototype.setConfirmedTagsByIds=function(e){this.tagArea.setConfirmedTagsByIds(e)&&(this.showResultPanel(Pe.CONFIRMED),this.incrementConfirmedCount(e.length))},t.prototype.setDeclinedTagsByIds=function(e){this.tagArea.setDeclinedTagsByIds(e)&&this.showResultPanel(Pe.DECLINED)},t.prototype.setDeletedTagsByIds=function(e){this.tagArea.setDeclinedTagsByIds(e)&&this.showResultPanel(Pe.DELETED)},t.prototype.reset=function(){this.tagArea.reset()},t.prototype.getTitle=function(){return this.title},t.prototype.getTags=function(){return this.tagArea.getTags()},t.prototype.getConfirmedTags=function(){return this.tagArea.getConfirmedTags()},t.prototype.incrementConfirmedCount=function(e){void 0===e&&(e=1),this.block.incrementConfirmedCount(e)},t.prototype.init=function(){var t=this.item.getAttribute("data-photo-url");t&&(e.prototype.init.call(this),this.checkItemHasNoSizes()&&this.correctTagView(t))},t.prototype.checkItemHasNoSizes=function(){return this.item.classList.contains(ae)},t.prototype.correctTagView=function(e){var t=this,o=new Image;o.onload=function(){var i=o.width,r=o.height;if(i&&r){var s=t.item.querySelector(".PhotoRecognizeBlockItem__photoFrame");if(!s)return;var n=(0,U.__read)(Ce.calculateTagAreaSizes(s,i,r),2),_=n[0],a=n[1],c=t.item.querySelector(".PhotoCarouselImage");if(!c)return;var l=t.item.querySelector(".PhotoCarouselItem__stub");l&&l.remove(),c.style.backgroundSize=_+"px "+a+"px",c.style.backgroundImage="url('"+e+"')";var d=_+1,u=a+1;t.tagArea.setSizes(d,u),t.tagArea.show(),t.item.classList.remove(ae)}},o.src=e},t.prototype.sendAnalytic=function(e,t){void 0===t&&(t={}),De(e,this.trackCode,t)},t}(pe);!function(e){e.CONFIRM_SUGGESTED_TAGS="CONFIRM_SUGGESTED_TAGS",e.DECLINE_SUGGESTED_TAGS="DECLINE_SUGGESTED_TAGS",e.DECLINE_USER_TAG="DECLINE_USER_TAG",e.CONFIRM_USER_TAG="CONFIRM_USER_TAG",e.DELETE_TAG="DELETE_TAG"}(ke||(ke={}));var Te=function(){function e(e){var t,o=this;this.isDestroyed=!1,this.countConfirmedTags=0,this.destroy=function(){o.isDestroyed||(o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.deInitListeners(),o.carousel.destroy(),o.items.forEach((function(e){return e.destroy()})),o.isDestroyed=!0)},this.handleOutsideConfirmationTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setConfirmedTagsByIds(i)}))},this.handleOutsideDeclinationTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setDeclinedTagsByIds(i)}))},this.handleOutsideDeletingTags=function(e){var t=e.detail.photoRawId,i=e.detail.tagIds;o.items.filter((function(e){return e.getPhotoRawId()===t})).forEach((function(e){return e.setDeletedTagsByIds(i)}))},this.next=function(){o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.carousel.getActiveIdx()!==o.items.length-1?o.carousel.next():o.countConfirmedTags?o.showEndCard():(o.removeBlock(),o.showThanksNotification())},this.removeBlock=function(){o.destroy(),o.post.remove()},this.onPhotoChangeClick=function(){o.nextPhotoTimerId&&(clearTimeout(o.nextPhotoTimerId),o.nextPhotoTimerId=null),o.skipActiveItemTags()},this.updateBlockTitle=function(){if(o.titleEl){var e=o.carousel.getActive().getTitle();e&&(o.titleEl.innerHTML=e)}},this.hideHelpHintClick=function(e){o.hintHelpId&&o.hintHelpHash&&((0,f.cancelEvent)(e),window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:o.hintHelpId,hash:o.hintHelpHash},{onDone:function(){var e;null===(e=o.hintHelpPanel)||void 0===e||e.remove()},onFail:function(){return console.error("something wrong with help hint"),!0}}))},this.post=e,this.titleEl=e.querySelector(".PhotoRecognizeBlock__title");var i=e.querySelector(".PhotoRecognizeBlock__inner");if(!i)throw new Error("PhotoRecognizeBlock: there is not inner");this.trackCode=e.dataset.trackCode,this.hintHelpId=e.dataset.hintHelpId,this.hintHelpHash=e.dataset.hintHelpHash,this.innerWrapperEl=i,this.items=this.createItems(e),this.carousel=new ue(e,this.items,{onPrevClick:this.onPhotoChangeClick,onNextClick:this.onPhotoChangeClick,onChange:this.updateBlockTitle}),this.hintHelpPanel=e.querySelector(".PhotoRecognizeBlockHint"),this.helpHintPanelHideBtn=e.querySelector(".PhotoRecognizeBlockHint__hide"),this.initListeners(),this.initFirstItems(),null===(t=window.cur.destroy)||void 0===t||t.push(this.destroy),window.cur.pvOneSuggestHintId=e.dataset.hintAlertId,window.cur.pvOneSuggestHintHash=e.dataset.hintAlertHash,null==window.cur.pvNeedShowAlertForOneSuggest&&(window.cur.pvNeedShowAlertForOneSuggest=Boolean(Number(e.dataset.needShowAlert)))}return e.prototype.initListeners=function(){var e;document.addEventListener(ke.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationTags),document.addEventListener(ke.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationTags),document.addEventListener(ke.DELETE_TAG,this.handleOutsideDeletingTags),null===(e=this.helpHintPanelHideBtn)||void 0===e||e.addEventListener("click",this.hideHelpHintClick)},e.prototype.deInitListeners=function(){var e,t;null===(e=this.closeEl)||void 0===e||e.removeEventListener("click",this.removeBlock),null===(t=this.helpHintPanelHideBtn)||void 0===t||t.removeEventListener("click",this.hideHelpHintClick),document.removeEventListener(ke.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationTags),document.removeEventListener(ke.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationTags),document.removeEventListener(ke.DELETE_TAG,this.handleOutsideDeletingTags)},e.prototype.initFirstItems=function(){this.items.slice(0,4).forEach((function(e){return e.init()}))},e.prototype.createItems=function(e){var t=this;return Array.from(e.querySelectorAll(".PhotoCarouselItem")).map((function(e){return new Oe(e,t)}))},e.prototype.nextWithDelay=function(){var e=this;this.nextPhotoTimerId||(this.nextPhotoTimerId=setTimeout((function(){e.nextPhotoTimerId=null,e.next()}),800))},e.prototype.incrementConfirmedCount=function(e){void 0===e&&(e=1),this.countConfirmedTags+=e},e.prototype.skipActiveItemTags=function(){this.carousel.getActive().skipTags()},e.prototype.showThanksNotification=function(){(0,h.showDoneBox)((0,a.getLang)("photo_recognition_thanks_notification"))},e.prototype.showEndCard=function(){var e,t=this.innerWrapperEl.parentElement;if(t){var o=this.getEndCardData(),i=(0,a.getLang)("photo_recognition_viewed_photos",this.items.length),r=o.subtitle||"",s=o.button,n=(0,w.se)('\n      <div class="PhotoRecognizeBlockEndCard">\n        <div class="PhotoRecognizeBlockEndCard__close"></div>\n        <div class="PhotoRecognizeBlockEndCard__title">'+i+'</div>\n        <div class="PhotoRecognizeBlockEndCard__subtitle">'+r+"</div>\n      </div>\n    ");if(s){var _=s.title,c=s.action.url,l=(0,w.se)('<a href="'+c+'" class="PhotoRecognizeBlockEndCard__action flat_button secondary">'+_+"</a>");n.appendChild(l)}this.closeEl=n.querySelector(".PhotoRecognizeBlockEndCard__close"),null===(e=this.closeEl)||void 0===e||e.addEventListener("click",this.removeBlock),t.appendChild(n),(0,w.hide)(this.innerWrapperEl),this.sendAnalytic("show_end_card")}},e.prototype.getEndCardData=function(){var e=this.post.getAttribute("data-end-card");return e?(0,fe.parseJSON)(e):{}},e.prototype.sendAnalytic=function(e,t){void 0===t&&(t={}),De(e,this.trackCode,t)},e}();var Le=o(40962),Be=o(26489);function Ae(e){if(window.vk.id&&(0,i.partConfigEnabled)("update_private_snippets_by_queue")){var t=Array.from(e.querySelectorAll(".article_snippet"));if(t.length){var o=[];t.forEach((function(e){if(window.vk.id&&e.dataset.needUpdate){var t=e.dataset.articleRawId;t&&o.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,G.intval)(e.dataset.isMiniSnippet)})}})),o.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(o)},{onDone:function(e){t.forEach((function(t){t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:function(){return(0,K.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0}})}}}var Ie=o(71516);function Re(e){var t,o,i,r=e.filterReason,s=e.ref,n=e.row,_=e.rowsContainer,a=e.section,c={contentId:null===(t=n.firstElementChild)||void 0===t?void 0:t.id,feedRowsCount:_.childElementCount,filterReason:r,ref:s,rowFlags:(i=[Boolean(null===(o=n.firstElementChild)||void 0===o?void 0:o.id),Boolean(n.firstElementChild)],i.map((function(e){return e?"1":"0"})).join("_")),section:a};(0,Ie.saveStatlogEvents)({name:"feed_pagination_item_filtered",value:c})}var Se=/^post(-?\d+_\d+)$/,We={shouldFilter:!1},Ue={shouldFilter:!0,filterReason:"empty"};function xe(e){var t=e.row.firstElementChild;return t?function(e){var t=function(e){return!!e.id&&Se.test(e.id)}(e),o=function(e){return!!e.id&&e.id.startsWith("feedback_row")}(e);if(!t&&!o)return We;if(!e.id||null===document.querySelector("#"+e.id))return We;return{shouldFilter:!0,filterReason:Ke({isNotification:o,isPost:t})}}(t):Ue}function Ke(e){return e.isNotification?"duplicate_notification":e.isPost?"duplicate_post":"duplicate_unknown"}var He,qe=o(41650),Ne=o(11417);!function(e){e.LIGHT="light",e.DARK="dark",e.DEFAULT="light"}(He||(He={}));var Fe;Symbol(),Symbol();!function(e){e.IsNew="is_new"}(Fe||(Fe={}));var je,Ve=function(e){return void 0!==e.base_id},Ge=function(e){return function(e){return void 0!==e.sticker_ids}(e)&&!Ve(e)};!function(e){e.Pack="pack",e.Style="style"}(je||(je={}));(function(){function e(e){var t=this;void 0===e&&(e=[]),this.pack=new Set,this.style=new Set,e.forEach((function(e){return t.add(e)}))}e.prototype.add=function(e){e&&(Ge(e)?this.pack.add(e):Ve(e)&&this.style.add(e))},e.prototype.getPack=function(){return this.pack.values().next().value},e.prototype.getStyles=function(){return Array.from(this.style.values())},e.prototype.getCount=function(){return this.pack.size+this.style.size}})(),function(){function e(e){var t=this;this.pack=[],this.style=[],e.forEach((function(e){return t.add(e)}))}e.prototype.add=function(e){var t=e.product;t&&(Ge(t)?this.pack.push(e):Ve(t)&&this.style.push(e))}}(),qe.default.getLang;function ze(e){var t,o;t=e,o=Ne.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light",t.querySelectorAll(".sticker_img["+o+"]").forEach((function(e){var t=e.getAttribute(o);t&&(e.src=t)}))}var $e=0,Ye=1,Qe=2;function Xe(){return Xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},Xe.apply(this,arguments)}var Je={sectionUpdateExceptions:["search","notifications","photos_search","mentions","articles","articles_search","likes","recommended","live","topics"],blockHideReason:function e(t,o){if(e.progress)return!1;e.progress=!0;var i="block_"+t,r=(0,w.ge)(i);delete cur.feedEntriesHTML[i],ajax.post("al_feed.php",{act:"a_block_hide_reason",block_id:t,reason:0|o,hash:(0,w.attr)(r,"data-hash"),ref:Je.getModuleRef(),pos:(0,w.attr)(r,"data-pos")},{onDone:function(t){e.progress=!1,t?(0,w.val)(r,t):(0,w.hide)(r)},hideProgress:function(){e.progress=!1}})},blockRestore:function(e){var t="block_"+e,o=(0,w.ge)(t);cur.feedEntriesHTML[t]&&(0,w.val)(t,cur.feedEntriesHTML[t]),ajax.post("al_feed.php",{act:"a_block_restore",block_id:e,hash:(0,w.attr)(o,"data-hash"),ref:Je.getModuleRef(),pos:(0,w.attr)(o,"data-pos")})},blockHide:function(e,t){if(!(0,E.actionsMenuItemLocked)(t)){(0,E.lockActionsMenuItem)(t);var o="block_"+e,i=(0,w.ge)(o),r=(0,w.geByClass1)("ui_actions_menu_wrap",i);ajax.post("al_feed.php",{act:"a_block_hide",block_id:e,hash:(0,w.attr)(i,"data-hash"),ref:Je.getModuleRef(),pos:(0,w.attr)(i,"data-pos")},{onDone:function(e){uiActionsMenu.toggle(r,!1),cur.feedEntriesHTML[o]=(0,w.val)(i),(0,w.val)(i,e)},hideProgress:E.unlockActionsMenuItem.pbind(t)})}},videoRecomsBlockHideCancel:function(){ajax.post("/al_feed.php",{act:"a_video_recom_hide_cancel"}),Je.restorePost("video_recoms")},videoRecomsBlockHideReason:function(e,t){(0,w.re)((0,w.geByClass1)("feed_rb_video_reason_wrap")),(0,w.show)((0,w.geByClass1)("feed_rb_video_reason_thankyou")),ajax.post("/al_feed.php",{act:"a_video_recom_hide_reason",reason:t,reason_hash:e})},expandVideosPost:function(e,t){var o=(0,w.geByClass1)("page_post_sized_thumbs",(0,w.domPN)(t)),i=0;(0,M.each)(o.children,(function(){if(!(0,w.isVisible)(this)&&((0,w.show)(this),++i>5))return!1})),(0,w.toggle)(t,!(0,w.isVisible)(o.children[o.children.length-1]))},update:function(e){if(!cur.feedUpdateLoading&&!(window.Notifier&&cur.add_queues&&cur.add_queues.length&&(cur.add_queues.forEach((function(e){Notifier.addKey(e,Je.updated)})),"news"!=cur.section)||"feed"!==cur.module||"top"==cur.subsection||(0,M.inArray)(cur.section,Je.sectionUpdateExceptions)||cur.isDisabledFeedAutoupdate)){var t=Math.random();if(!("news"!=cur.section&&"comments"!=cur.section&&t>.3||"news"==cur.section&&(e||t>.05))){cur.feedUpdateLoading=!0;var o=Je.getSectionParams(cur.section);(0,M.extend)(o,cur.navParams),ajax.post("al_feed.php?au_"+cur.section,(0,M.extend)(o,{timestamp:cur.timestamp,posted:e?1:"",queue:cur.add_feed_queue?1:0}),{onDone:function(t,o,i){if(cur.feedUpdateLoading=!1,1!=e||o&&-1!=o.indexOf(vk.id+"")){if(!("feed"!==cur.module||t.section!=cur.section||t.timestamp<cur.timestamp||i<cur.timestamp)){(0,y.statlogsValueEvent)("feed_check_update",!!o),t.count+=cur.count;var r,s,n,_,c=cur.rowsCont,l=(0,w.ce)("div"),d=0;if("news"==cur.section){if(_=(0,g.scrollGetY)(),o){for(l.innerHTML=o;l.lastChild;)r=l.lastChild,c.insertBefore(r,c.firstChild),Je.onPostLoaded(r,!0);(0,M.each)((0,w.geByClass)("ts"+i,c),(function(e,t){d+=this.offsetHeight;var o=null==t||null==t.querySelector?void 0:t.querySelector(".post");o&&J(o),cur.feedUnreadCount++}))}d&&_>100&&(0,g.scrollToY)(_+d,0,!1,!0)}else if(o)for(l.innerHTML=o;r=l.lastChild;)if("DIV"==r.tagName)if("podcasts_recommended_block"!==r.id)if((n=r.firstChild.id.substr(4))&&cur.wallLayer==n)l.removeChild(r);else if(s=(0,w.ge)("post"+n)){var u=function(){if(!(0,w.hasClass)(s.parentNode,"feed_row"))return{v:void 0};var e=(0,w.ge)("replies"+n),t=e.nextSibling,o=0;if((0,M.each)([].slice.call((0,w.geByClass)("reply",r,"div")),(function(){(0,w.ge)(this.id)||((0,w.addClass)(this,"new_reply"),e.appendChild(this),o++)})),o){var i=s.parentNode.offsetHeight,_=(0,w.geByClass)("new_reply",e,"div").length;t&&"replies_open"==t.className||(t=(0,w.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(n),role:"button",tabIndex:0}),e.parentNode.insertBefore(t,e.nextSibling)),t.innerHTML=(0,a.getLang)("wall_x_new_replies_more",Math.min(100,_)),t.newCnt=_;var d=(0,g.scrollGetY)(),u=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,h=(0,w.getXY)(t)[1],p=s.parentNode.offsetHeight;i=p-i,(0,M.inArray)(n,cur.feedUnread)||cur.feedUnread.unshift(n),!cur.idleManager.isIdle&&h>d+100&&h<d+u+100?(c.insertBefore((0,w.ge)("post_ph"+n)||(0,w.ce)("div",{id:"post_ph"+n}),c.firstChild),(0,M.inArray)(n,cur.feedToSort)||cur.feedToSort.push(n)):((0,w.re)(s.parentNode),c.insertBefore(s.parentNode,c.firstChild),h>d+u+100&&(i=p),i&&(0,g.scrollToY)((0,g.scrollGetY)()+i,0,!1,!0)),cur.feedUnreadCount+=o}l.removeChild(r)}();if("object"==typeof u)return u.v}else _=(0,g.scrollGetY)(),c.insertBefore(r,c.firstChild),Je.onPostLoaded(r,!0),d=r.offsetHeight,_>100&&(0,g.scrollToY)(_+d,0,!1,!0);else l.removeChild(r);else l.removeChild(r);Je.applyOptions(t),Je.updateTitle()}}else setTimeout(Je.update.pbind(2),2e3)},onFail:function(){return cur.feedUpdateLoading=!1,!1},showProgress:function(){cur.feedUpdateLoading=!0},hideProgress:function(){cur.feedUpdateLoading=!1}})}}},getNewQKey:function(e){var t={act:"a_get_key",only_update:cur.add_feed_queue?1:0,need_ignore:(0,G.isArray)(cur.ignore_owners)?0:1},o={onDone:function(o,r,s){if(cur.section!=i)return;if(cur.add_feed_queue=s,o)cur.add_queues=o,setTimeout(Je.update.pbind(0),0);else if(!t.only_update){var n=r;return void(cur.timestamp=(n||(0,G.vkNow)()/1e3)-e)}(0,G.isArray)(r)&&(cur.ignore_owners=r)},local:1},i=cur.section;ajax.post("al_feed.php",Xe({},Je.getSectionParams(cur.section),{},t,{queue:1}),o)},updated:function(e,t){cur.queueTO=cur.queueTO||(0,G.irand)(0,5e3),setTimeout(Je.handleQueueEvent.pbind(e,t),cur.queueTO)},handleQueueEvent:function(e,t){if(("search"==cur.section||"news"==cur.section||!cur.section)&&(0,G.isArray)(cur.add_queues)){var o=cur.add_queues.find((t=>D(t)===e));if(o){if(t.failed){cur.add_queues=!1,cur.add_feed_queue=null;var i=curNotifier.error_timeout||1;return clearTimeout(cur.lp_error_to),void(cur.lp_error_to=setTimeout(Je.getNewQKey.bind(Je).pbind(i),1e3*i))}if((0,G.isArray)(t.events)&&t.events.length){o.ts=t.ts,t.key&&(o.key=t.key);var r=(0,g.scrollGetY)(),s=0;(0,M.each)(t.events,(function(){if((0,G.isObject)(this))return Wall.processQueueEvent(this);s+=Je.pushEvent(this.split("<!>"),r+(0,w.getSize)("page_header_cont")[1])}));var n=(0,g.scrollGetY)();s&&Math.abs(r-n)<100&&(cur.leftMenuDelta=s,(0,g.scrollToY)(n+s,0,!1,!0)),Je.updateTitle(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}}}},needScrollPost:function(e,t){return e+80>(0,w.getXY)(t)[1]||cur.storyLayer||window.mvcur&&mvcur.mvShown||window.pvcur&&cur.pvShown},pushEvent:function(e,t){var o,i,s,n=e[0],c=e[1],l=e[2],d=(0,w.ge)("post"+l),u=cur.section,h="search"!=u?(0,M.intval)(e.pop()):0,p=0,f=function(e){return(0,M.intval)((0,w.getStyle)((0,w.domByClass)(e,"page_block"),"marginTop"))||(0,M.intval)((0,w.getStyle)((0,w.domByClass)((0,w.domNS)(e),"page_block"),"marginTop"))||15};if(!cur.options||n!=cur.options.qversion)return 0;switch((Wall.isArchiveWall()?"archive_post"===c:"reveal_post"===c)&&(c="res_post"),(Wall.isArchiveWall()?"reveal_post"===c:"archive_post"===c)&&(c="del_post"),c){case"new_post":if(d)break;var g=$e;if((0,M.intval)(e[11])&&(0,M.intval)(e[11])!=vk.id)return ajax.post("al_feed.php",{act:"a_need_own_reply",oid:(0,M.intval)(e[11])},{onDone:function(o){o&&(e[11]=0,Je.pushEvent(e,t))}}),0;if("search"!=u){var m=l.split("_")[0];e[8]=(0,M.intval)(e[8])>0&&4==(4&h)?"1":"0",m<0&&(g=8&h?Qe:2&h?Ye:$e)}"search"==u&&(0,y.statlogsValueEvent)("feed_switch",0,"search_update",cur.options.q&&"#"==cur.options.q.charAt(0)?"hashtag":"");var v=cur.rowsCont,b=v.childNodes,E=Wall.getNewPostHTML(e,g,Je.feedPostRepl);if(!E)break;var P,C,D,k,O,T,L=e[12],B="search"!=u&&(window._wf<=0||(0,w.hasClass)(cur.feedEls.wrap,"feed_has_new")||Je.needScrollPost(t,v)),A=cur.storyLayer;A&&(B=!0);var I=!1,R=E;if(B&&(E=Wall.updatePostImages(E)),L){if(cur.ignore_owners.length&&(0,M.inArray)((0,M.intval)(L),cur.ignore_owners))break;if(C=(0,w.geByClass1)("feed_reposts_wrap"+L,v,"div"))D=(0,w.geByClass1)("feed_reposts_first",C,"div").firstChild,k=(0,w.geByClass1)("feed_reposts_group",C,"div"),O=(0,w.geByClass1)("feed_reposts_more_link",C),Je.needScrollPost(t,D)&&(p-=D.offsetHeight+f(D)),D.parentNode.replaceChild(P=(0,w.se)(R),D),k.insertBefore(D,k.firstChild),(0,w.isVisible)(k)||j.FlatButton.setLabel(O,(0,a.getLang)("news_show_X_reposts",k.childNodes.length)),C=C.parentNode,v.firstChild!=C&&v.insertBefore(C,v.firstChild),Je.needScrollPost(t,C)&&(p+=C.offsetHeight+f(C)),C.bits=0;else if((T=(0,w.geByClass)("feed_repost"+L,v,"div"))&&T.length){E=(0,w.rs)(cur.wallTpl.grouped_posts,{place:L,random:(0,G.irand)(1e8,2e8),first:E,other:"",label:(0,a.getLang)("news_show_X_reposts",T.length)});var S=(0,w.se)('<div class="feed_row'+(B?"_unshown":"")+'">'+E+"</div>");v.insertBefore(S,v.firstChild),!B&&Je.needScrollPost(t,S)&&(p+=S.offsetHeight+f(S)),I=!0,C=S.firstChild,P=(0,w.geByClass1)("feed_reposts_first",C,"div"),k=(0,w.geByClass1)("feed_reposts_group",C,"div"),(0,M.each)((0,M.clone)(T),(function(){Je.needScrollPost(t,this)&&(p-=this.offsetHeight+f(this)),(0,w.re)(this.parentNode),k.appendChild(this.firstChild)}))}else P=(0,w.se)('<div class="feed_row'+(B?"_unshown":"")+'"><div class="feed_repost'+L+'">'+E+"</div></div>"),v.insertBefore(P,v.firstChild),I=!0,!B&&Je.needScrollPost(t,P)&&(p+=P.offsetHeight+f(P))}else P=(0,w.se)('<div class="feed_row'+(B?"_unshown":"")+'">'+E+"</div>"),v.insertBefore(P,v.firstChild),I=!0,!B&&Je.needScrollPost(t,P)&&(p+=P.offsetHeight+f(P));var U=(0,w.geByClass1)("post",P);0==e[8]&&(0,w.addClass)(U,"closed_comments"),cur.deepRepliesActive&&(0,w.addClass)(U,"deep_active"),B&&I&&(cur.newPostsCount=cur.newPostsCount?cur.newPostsCount+1:1,cur.feedEls.newPosts.innerHTML=(0,a.getLang)("news_new_posts",cur.newPostsCount),(0,w.addClass)(cur.feedEls.wrap,"feed_has_new"),1==cur.newPostsCount&&Je.needScrollPost(t,cur.feedEls.newPosts)&&!A&&(p+=(0,w.getSize)(cur.feedEls.newPosts)[1])),r.AudioUtils.updateQueueReceivedPost(P),(0,Be.updateNarrativeSnippetsFromQueueByPost)(P),Ae(P),cur.feedUnreadCount++,"search"!=u&&U&&J(U),b.length>300?v.removeChild(b[300]):b.length<=1&&(0,w.removeClass)(cur.feedEls.wrap,"feed_is_empty"),Wall.updateMentionsIndex();break;case"new_post_reply":if(d)break;var x=cur.rowsCont,K=x.childNodes,H=Wall.getNewPostHTML(e,!1,Je.feedPostRepl);if(!H)break;var q=(0,w.se)('<div class="feed_row">'+H+"</div>");x.insertBefore(q,x.firstChild),Je.needScrollPost(t,q)&&(p+=q.offsetHeight+f(q)),(0,Be.updateNarrativeSnippetsFromQueueByPost)(q),Ae(q),ze(q),cur.feedUnreadCount++,K.length>300?x.removeChild(K[300]):K.length<=1&&(0,w.removeClass)(cur.feedEls.wrap,"feed_is_empty");break;case"edit_post":var F,V=(0,w.ge)("wpt"+l);if(!(0,w.isVisible)(d)||!V)break;var z=(0,w.geByClass1)("wall_post_more",V);z&&(z=(0,w.isVisible)((0,w.domNS)(z))),(F=Je.needScrollPost(t,V))&&(p-=V.offsetHeight);var $=(0,w.rs)(e[3],{poll_hash:cur.wallTpl.poll_hash}),Y=(0,w.ge)("post"+l);Y&&!(0,w.isVisible)(Y.parentNode)&&($=Wall.updatePostImages($)),(0,w.val)(V,$),z&&(z=(0,w.geByClass1)("wall_post_more",V))&&z.onclick(),F&&(p+=V.offsetHeight),(0,Be.updateNarrativeSnippetsFromQueueByPost)(V),Ae(V),s=V,(0,X.triggerAnimationClass)(s,"post_highlight_updated_content",3e3),window.Wall&&Wall.updatePostAuthorData(l);break;case"edit_reply":var Q=e[3],Z=(0,w.ge)("wpt"+Q);if(!(0,w.isVisible)("post"+Q)||!Z)break;var ee=(0,w.geByClass1)("wall_reply_more",Z);ee&&(ee=(0,w.isVisible)((0,w.domNS)(ee)));var te=e[4];(0,w.val)(Z,te),ee&&(ee=(0,w.geByClass1)("wall_reply_more",Z))&&ee.onclick(),(0,Be.updateNarrativeSnippetsFromQueueByPost)(Z),Ae(Z),ze(Z),function(e){(0,X.triggerAnimationClass)(e,"reply_highlight_updated_content",3e3)}(Z);break;case"post_parsed_link":if(!d)break;var oe=(0,w.geByClass1)("wall_postlink_preview_btn_disabled",d);if(!oe)break;var ie=e[3];if("1"===ie)(0,w.removeClass)(oe,"wall_postlink_preview_btn_disabled");else if("0"===ie)(0,w.re)(oe);else if(ie){(0,w.removeClass)(oe,"wall_postlink_preview_btn_disabled");var re=(0,w.geByClass1)("flat_button",oe);re&&(re.setAttribute("href",e[3]),re.removeAttribute("onclick"))}break;case"del_post":if(d){var se=(0,w.domClosest)("feed_row",d)||(0,w.domClosest)("feed_row_unshown",d)||d;cur.wallMyDeleted[l]||(Je.needScrollPost(t,d)&&(p-=d.offsetHeight+f(d)),(0,_.revertLastInlineVideo)(d),(0,w.re)(se)),cur.options.offset--,(0,w.hasClass)(cur.feedEls.wrap,"feed_has_new")&&!(0,w.isVisible)(se)&&(cur.newPostsCount--,cur.newPostsCount?cur.feedEls.newPosts.innerHTML=(0,a.getLang)("news_new_posts",cur.newPostsCount):(0,w.removeClass)(cur.feedEls.wrap,"feed_has_new"))}break;case"res_post":d&&cur.options.offset++;break;case"new_reply":if(!d||cur.wallMyReplied[l]||(0,w.ge)("post"+e[3]))break;if((0,w.hasClass)((0,w.ge)("post"+l),"deep_active")){var ne=Wall.addNewReply(e);p+=ne[0];break}var _e=(0,w.ge)("replies"+l),ae=(0,w.ge)("replies_wrap"+l),ce=d.offsetHeight,le=l.split("_")[0]<0?8&h?Qe:2&h?Ye:$e:$e,de=Wall.getNewReplyHTML(e,le);if(!de)break;var ue,he=!1,pe=!1;if((0,w.isVisible)(_e)&&(0,w.isVisible)(ae)&&!(0,w.isVisible)("reply_link"+l)){ue=_e.nextSibling;var fe=(0,w.geByClass)("new_reply",_e,"div").length+1;if(cur.wallMyOpened[l]){ue&&"replies_open"==ue.className&&(0,w.re)(ue),pe=!0;var ge=(0,w.geByClass1)("wr_header",_e,"a"),me=(0,w.geByClass)("reply",_e,"div").length+1,we=me;ge&&(we=(0,M.intval)(ge.getAttribute("offs").split("/")[1])+1),(we>5||me<we)&&(ge||_e.insertBefore(ge=(0,w.ce)("a",{className:"wr_header"}),_e.firstChild),Wall.updateRepliesHeader(l,ge,me,we))}else de=Wall.updatePostImages(de),he=(0,w.se)(de),(0,w.addClass)(he,"new_reply"),ue&&"replies_open"==ue.className||(ue=(0,w.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(l),role:"button",tabIndex:0}),_e.parentNode.insertBefore(ue,_e.nextSibling)),ue.innerHTML=(0,a.getLang)("wall_x_new_replies_more",Math.min(100,fe)),ue.newCnt=fe}else(0,w.re)("reply_link"+l),(0,w.show)(ae,_e),pe=!0;l.split("_")[0]==vk.id&&cur.feedUnreadCount++,he||(he=(0,w.se)(de)),_e.appendChild(he),Je.needScrollPost(t,pe?he:ue)&&(p+=d.offsetHeight-ce),he instanceof HTMLElement&&((0,Be.updateNarrativeSnippetsFromQueueByPost)(he),Ae(he),ze(he)),pe&&function(e){(0,X.triggerAnimationClass)(e,"reply_highlight_updated",3e3)}(he),Wall.repliesSideSetup(l),Wall.updateMentionsIndex(),Likes.update("wall"+l,{comment_num:e[13]});break;case"del_reply":if(!cur.wallMyDeleted[l]&&d){if((0,w.hasClass)((0,w.gpeByClass)("post",d),"deep_active")){var ve=Wall.removeDeepReply(e);p+=ve[0];break}Je.needScrollPost(t,d)&&(p-=d.offsetHeight);var be=d.parentNode.id.match(/replies(-?\d+_\d+)/);(0,_.revertLastInlineVideo)(d),(0,w.re)(d),be&&Wall.repliesSideSetup(be[1])}break;case"view_post":Likes.update("wall"+l,{views_num:Wall.formatCount((0,M.intval)(e[3]))});break;case"like_post":case"like_reply":if(!d)break;var Ee="like_reply"==c?"wall_reply"+l:l,Pe=d&&(0,w.domByClass)(d,"_like_wrap"),Ce=d&&(0,w.domByClass)(d,"_share_wrap"),ye=(i=N(e),(o={})[W.REACTIONS_COUNTS_RESPONSE_FIELD]=null==i?void 0:i.counts,o);Wall.likeFullUpdate(Pe,Ee,Xe({isQueueUpdate:!0,like_my:Pe&&(0,w.hasClass)(Pe,"my_like"),like_num:e[3],like_title:!1,share_my:Ce&&(0,w.hasClass)(Ce,"my_share"),share_num:e[4],share_title:!1},ye))}return p},feedPostRepl:function(e,t){e.replies=cur.wallTpl.post_replies;var o={full_id:t[2],item_id:"wall_"+t[2],sec_name:(0,G.stripHTML)(t[3]),date:Wall.getNowRelTime(),del:cur.wallTpl.spam};if("search"==cur.section&&cur.q){var i,r,s,n=e.text||"",_=cur.q.toLowerCase().split(/[\s.,:;!?()]/),a=[],c=(n=n.replace(/<(.|\n)+?>/g,(function(e){return a.push(e),""}))).toLowerCase();for(i=_.length-1;i>=0;i--)if(s=_[i],(0,M.trim)(s))for(r=0;-1!=(r=c.indexOf(s,r));)n.charAt(r-1)!=String.fromCharCode(2)?(n=n.substr(0,r)+""+i+""+n.substr(r+s.length),c=c.substr(0,r)+""+i+""+c.substr(r+s.length)):r+=2;n=n.replace(/\x02(\d+)\x02/g,(function(e,t){return'<span class="highlight">'+_[t]+"</span>"})),n=n.replace(/\x01/g,(function(){return a.shift()||""})),o.text=n,"new_post_reply"==t[1]&&(o.date_postfix=t[7])}return o},reSortItems:function(){cur.feedToSort&&cur.feedToSort.length&&((0,M.each)(cur.feedToSort,(function(e,t){var o=(0,w.ge)("post_ph"+t),i=(0,w.ge)("post"+t).parentNode;o&&i&&(o.parentNode.insertBefore(i,o),(0,w.re)(o))})),cur.feedToSort=[],(0,g.scrollToY)(0,0))},showNewPosts:function(){(0,w.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0;var e=(0,w.ge)("feed_rows");Wall.loadPostImages(e),(0,M.each)((0,w.geByClass)("feed_row_unshown",e,"div"),(function(){(0,w.replaceClass)(this,"feed_row_unshown","feed_row")}))},updateTitle:function(){cur.idleManager&&(cur.idleManager.isIdle||(cur.feedUnreadCount=0),(0,w.setDocumentTitle)((cur.feedUnreadCount?"("+cur.feedUnreadCount+") ":"")+cur.feedInitialTitle))},toggleTabsMenuTab:function(e,t){var o=(0,w.geByClass1)("feed_section_"+e,cur.feedEls.rmenu);o&&(0,w.toggleClass)(o,"ui_rmenu_item_hidden",!t)},toggleTabsMenu:function(e,t){var o=(0,w.ge)("feed_add_list_icon");return void 0===t&&(t=!(0,w.hasClass)(o,"shown")),s.browser.mozilla&&(0,w.setStyle)("page_body",{overflow:t?"visible":""}),uiActionsMenu.toggle(o,t),t&&(0,f.addEvent)(document,"mousedown",(function e(t){Je.toggleTabsMenu(!1,0),(0,f.removeEvent)(document,"mousedown",e)})),e&&(0,f.cancelEvent)(e)},checkTabsFilter:function(e,t){var o,i,r,s=t==cur.section,n=cur.my_feed_types.tabs;switch(t){case"news":return!1;case"newlist":return Je.addList();default:if(r=t.match(/list(\d+)/))return Je.editList(r[1])}o=-1!=(i=(0,M.indexOf)(n,t)),(0,w.toggleClass)(e,"checked",!o),o?(n.splice(i,1),s&&(cur.onSaveTabs=function(e,t){Je.toggleTabsMenu(null,!1),Je.switchSection("news")}.pbind(t,o))):n.push(t),cur.my_feed_types.tabs=n,Je.toggleTabsMenuTab(t,!o||s),uiRightMenu.fixScroller((0,w.ge)("ui_rmenu_"+cur.section+(cur.list||""))),clearTimeout(cur.saveTabsTO),cur.saveTabsTO=setTimeout(Je.saveTabs,500)},hasSearchParams:function(e){var t=!1;return(0,M.each)(e,(function(e,o){if((!e.indexOf("c[")&&"c[section]"!==e||"q"==e)&&o)return t=!0,!1})),t},getSectionParams:function(e){var t={section:e};switch(e){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"podcasts":case"articles":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"owner":(t.owner=cur.owner)||delete t.section;break;case"source":case"notifications":(t.source=cur.source)||delete t.source;break;case"list":void 0===(t.subsection=cur.subsections["list"+cur.list])&&delete t.subsection,(t.list=cur.list)||delete t.list;break;case"search":var o=(0,w.ge)("search_filters_form");if(o){var i=(0,M.serializeForm)(o)||{};for(var r in i)i[r]&&"0"!=i[r]||delete i[r];(0,M.extend)(t,i)}t["c[q]"]=(0,M.trim)((0,w.val)(cur.feedEls.search));break;case"photos_search":(t.q=(0,M.trim)((0,w.val)(cur.feedEls.search)))||delete t.section,(t.sort=(0,M.intval)(cur.search_sort_value))||delete t.sort;break;case"trends_search":window.nav.objLoc.trend_id&&(t.trend_id=window.nav.objLoc.trend_id),(t.q=(0,M.trim)((0,w.val)(cur.feedEls.search)))||delete t.section,(t.sort=(0,M.intval)(cur.search_sort_value))||delete t.sort;break;case"articles_search":(t.q=(0,M.trim)((0,w.val)(cur.feedEls.search)))||(t.section="articles");break;case"comments":cur.reposts&&(t.reposts=cur.reposts);break;case"mentions":var s=new URLSearchParams(location.search);s.delete("ref"),history.replaceState(null,"","?"+s+location.hash),cur.mentionObj&&cur.mentionObj!=vk.id&&(t.obj=cur.mentionObj)}return t},switchNotifyList:function(e,t){uiRightMenu.go((0,w.geByClass1)("feed_section_"+e),!1,!1),Je.go(t)},switchSubSection:function(e,t,o){if(t&&(0,f.checkEvent)(t))return!0;var i=cur.section;"list"===cur.section&&(i="list"+cur.list),cur.subsection=cur.subsections[i]=e;var r=Je.getSectionParams(cur.section);r.hash=o,delete cur.feedUpdateLoading,delete cur.isFeedLoading,nav.go((0,M.extend)(r||{},{0:"feed"})),uiRightMenu.showProgress(cur.feedEls.rmenu)},switchSection:function(e,t,o){if(t&&(0,f.checkEvent)(t))return!0;if((0,w.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,"photos_search"==e&&!(0,M.trim)((0,w.val)(cur.feedEls.search))){if("photos_search"!=cur.section)return!1;e="photos"}"comments"==e&&(cur.reposts=cur.options.reposts=""),(0,y.statlogsValueEvent)("feed_switch",0,e),Je.setSection(e,1);var i=Je.getSectionParams(e||"news");delete cur.feedUpdateLoading,delete cur.isFeedLoading;var r=!o&&(0,M.extend)(i||{},{0:"feed"});return uiRightMenu.go((0,w.geByClass1)("feed_section_"+e),!1,r),!1},setSection:function(e,t,o){if(t=t||0,cur.prevSection=cur.section,!(e==cur.section&&t<2)&&e){if(uiRightMenu.hideProgress(cur.feedEls.rmenu),cur.feedEls.search&&uiSearch.hideProgress(cur.feedEls.search),t>1){Page.playVkFestBanner&&Page.playVkFestBanner(),(0,w.toggleClass)(cur.feedEls.wrap,"feed_submit_shown",(0,M.inArray)(e,cur.options.feed_types.tabs.concat(["list","likes"]))),(0,w.toggleClass)(cur.feedEls.wrap,"feed_submit_only_shown",~["recommended","search","updates","comments"].indexOf(e));var i=(0,M.inArray)(e,["articles_search","articles","search","photos_search","photos","trends","trends_search"]);(0,w.toggleClass)(cur.feedEls.wrap,"feed_search_shown",i),i&&(0,w.elfocus)(cur.feedEls.search),"search"===e&&o.stories_block_show?(0,w.addClass)(cur.feedEls.wrap,"feed_submit_shown_stories"):(0,w.removeClass)(cur.feedEls.wrap,"feed_submit_shown_stories"),cur.section&&(0,w.val)(cur.feedEls.search,"")}2==t&&window.Stories&&Stories.updateFeedStories(e,o),cur.my_feed_types&&(~(0,M.indexOf)(cur.my_feed_types.optional_tabs,cur.section)&&!~(0,M.indexOf)(cur.my_feed_types.tabs,cur.section)&&Je.toggleTabsMenuTab(cur.section,!1),~(0,M.indexOf)(cur.my_feed_types.optional_tabs,e)&&!~(0,M.indexOf)(cur.my_feed_types.tabs,e)&&Je.toggleTabsMenuTab(e,!0)),cur.section=e,4!=t?(cur.editingHide=("notifications"==e||"replies"==e)&&Je.notifyCheckHideReply,cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()):Je.searchUpdate()}},applyOptions:function(e,t){t=t||0,e.no_left_ads&&(cur.no_left_ads=!0),e.owner&&(cur.owner=e.owner),cur.subsection=e.subsection||"",Je.setSection(e.section,t,e),cur.options||(cur.options={reply_names:{}}),(0,M.extend)(cur.options.reply_names,e.reply_names),delete e.reply_names,(0,M.extend)(cur,e);var o=cur.section;if("list"===cur.section&&(o="list"+e.list),cur.subsections[o]=cur.subsection,e.loc&&2==t&&nav.setLoc(e.loc),e.section&&"news"==e.section&&e.subsection&&"top"==e.subsection&&(0,y.statlogsValueEvent)("feed_switch",0,"top_news",t),void 0!==e.filters){var i=(0,w.ge)("search_filters_minimized"),r=i&&(0,w.hasClass)(i,"ui_rmenu_item_expanded"),n=!!i;(0,w.val)("feed_filters",e.filters),window.searcher&&n&&F.searcher.toggleMinimizedFilters((0,w.ge)("search_filters_minimized"),r,!0)}if(e.script&&(0,v.evalWithLogging)(e.script),e.htitle&&(cur.feedInitialTitle=document.title=(0,G.replaceEntities)((0,G.stripHTML)(e.htitle))),void 0!==e.add_feed_queue&&null!==e.add_feed_queue?(cur.add_feed_queue=!1,e.add_feed_queue=!1,Je.getNewQKey(0),!0!==e.add_queue&&(cur.add_queue=e.add_queue)&&setTimeout(Je.update.pbind(0),0)):t&&"search"!=cur.section&&"news"!=cur.section&&cur.section&&(cur.add_feed_queue=!1,e.add_feed_queue=!1),e.add_queues&&(cur.add_queues=e.add_queues,setTimeout(Je.update.pbind(0),0)),e.q){(0,w.val)(cur.feedEls.search,(0,G.replaceEntities)(e.q));var _=e.q;_.length>30&&(_=(0,M.trim)(_.substr(0,30))+"...")}e.last_view&&(cur.options.last_view=e.last_view),void 0!==e.feedback_list&&(cur.options.feedback_list=e.feedback_list),Je.searchUpdate(),"comments"!=cur.section||cur.reposts||(0,w.toggle)("comments_filters",!cur.reposts),(0,G.isString)(cur.all_shown_text)&&(0,w.val)("all_shown",cur.all_shown_text),(0,G.isString)(cur.show_more_text)&&(0,w.val)("show_more_link",cur.show_more_text),cur.empty_text&&(0,w.val)("feed_empty",cur.empty_text),cur.count>=0&&(0,w.re)("feed_error_wrap");var a=!((0,w.geByClass1)("feed_row",cur.rowsCont,"div")||!1),c=(0,w.ge)("feed_rows_next");if(a?((0,w.toggleClass)(cur.feedEls.wrap,"feed_is_empty",!(0,w.isVisible)("feed_error_wrap")),(0,w.hide)("all_shown"),(0,w.toggle)("show_more_link",cur.count>0&&!cur.all_shown)):!cur.all_shown||c&&c.firstChild?((0,w.hide)("all_shown"),(0,w.show)("show_more_link"),(0,w.removeClass)(cur.feedEls.wrap,"feed_is_empty")):((0,w.hide)("show_more_link"),(0,w.show)("all_shown"),(0,w.removeClass)(cur.feedEls.wrap,"feed_is_empty"),(0,w.re)(c)),e.playlistsData&&(e.playlistsData=JSON.parse(e.playlistsData),cur.pageVideosList=(0,M.extend)(cur.pageVideosList||{},e.playlistsData)),("notifications"==cur.section||"replies"==cur.section)&&cur.notify){var l=(0,w.ge)("feedback_row"+cur.notify);l&&l.onclick&&(setTimeout((function(){l.onclick(),(0,g.scrollToY)((0,w.getXY)(l)[1],0)}),s.browser.msie?100:0),delete cur.notify)}cur.feedSection&&cur.feedSection(e.section,e.subsection)},showMore:function(){if(!cur.isFeedLoading){cur.disableAutoMore=!1;var e,t=(0,w.ge)("feed_rows_next");if(t){if(t.firstChild)for(;t.firstChild;)e=t.firstChild,cur.rowsCont.insertBefore(e,t),Je.onPostLoaded(e,!0);(0,w.re)(t)}"live"==cur.section&&(cur.all_shown=!0);var o=(0,w.ge)("show_more_link");if(cur.all_shown&&((0,w.hide)(o),(0,w.show)("all_shown")),"live"!=cur.section){var r=!1,s=function(e){e.keyCode==f.KEY.ESC&&(r=!0)};(0,f.addEvent)(document,"keyup",s);var _=Je.getSectionParams(cur.section||"news");(0,M.extend)(_,{offset:cur.offset,from:cur.from,part:1,more:1,last_view:cur.options.last_view}),(0,M.extend)(_,cur.navParams),cur.options.feedback_list&&(_.list=cur.options.feedback_list),nav.objLoc.situational_suggest_id&&(_.situational_suggest_id=nav.objLoc.situational_suggest_id);var a=cur.section;ajax.post("al_feed.php?sm_"+cur.section,_,{onDone:function(e,t){if((0,f.removeEvent)(document,"keyup",s),a==cur.section)if(r)cur.disableAutoMore=!0;else{if(t){var o,_=(0,w.ce)("div");for(_.innerHTML=t;o=_.firstElementChild;){var c,l=xe({row:o});if(l.shouldFilter)console.info("Feed: skipping loaded row",o),_.removeChild(o),(0,i.randEnabled)(null!=(c=window.cur.feed_pagination_filtering_log_prob)?c:.01)&&Re({filterReason:l.filterReason,ref:Je.getModuleRef(),row:o,rowsContainer:cur.rowsCont,section:cur.section});else cur.rowsCont.appendChild(o),Je.onPostLoaded(o,!0)}}(0,n.shortCurrency)(),Je.applyOptions(e),setTimeout(Je.scrollCheck,200)}},showProgress:function(){(0,E.lockButton)(o),cur.isFeedLoading=!0},hideProgress:function(){if((0,E.unlockButton)(o),cur.isFeedLoading=!1,o.seen){var e=Math.ceil((Date.now()-o.seen)/1e3),t=cur.section+(cur.subsection?"_"+cur.subsection:"");(0,y.statlogsValueEvent)("feed_load_more_seen_time",e,t),o.seen=!1}},cache:1})}}},showMoreFriends:function(e,t){(0,f.checkEvent)(t)||(j.FlatButton.lock(e),cur._back.show.push((function(){j.FlatButton.unlock(e)})),nav.go("/friends?act=find"))},showMorePublics:function(e,t){(0,f.checkEvent)(t)||((0,E.lockButton)(e),cur._back.show.push((function(){(0,E.unlockButton)(e)})),nav.go("/groups?act=catalog&c%5Bcategory%5D=0 "))},getTypesSection:function(){return"owner"===cur.section?cur.owner>0?"person":"group":cur.section},checkFilter:function(e,t){var o,i=Je.getTypesSection(),r=cur.my_feed_types[i],s=cur.feed_types[i];"notifications"!=i?(!0===r&&(r=(0,M.clone)(s)),-1!=(o=(0,M.indexOf)(r,t))?r.splice(o,1):(r.push(t),r.length==s.length&&(r=!0)),(0,E.checkbox)(e),cur.my_feed_types[i]=r,Je.updateTypesCookie(),Je.setFiltersUpdatePage(),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)):Je.setNotifyFilter(e,t)},setFilter:function(e,t){var o=Je.getTypesSection(),i=(0,w.ge)(o+"_type_filter"),r=!0;"notifications"!=o&&((0,M.each)((0,w.geByClass)("_feed_filter_row",i,"div"),(function(){if((0,E.isChecked)(this)&&this!=e)return r=!1})),r?(cur.my_feed_types[o]=!0,(0,M.each)((0,w.geByClass)("_feed_filter_row",i,"div"),(function(){(0,E.checkbox)(this,!0)}))):((0,M.each)((0,w.geByClass)("_feed_filter_row",i,"div"),(function(){(0,E.checkbox)(this,!1)})),cur.my_feed_types[o]=[t],(0,E.checkbox)(e,!0)),Je.updateTypesCookie(),Je.setFiltersUpdatePage({force_expand_filters:1}),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu))},setFiltersUpdatePage:function(e){e=e||{};var t=nav.strLoc;if("updates"===cur.section){t.match(/\&filters\_expanded\=1/)||(0,w.ge)("updates_show_all_filters")&&!e.force_expand_filters||(t+="&filters_expanded=1"),t=t.replace(/\&filters\_shown\=([a-z\,]+)/,"");for(var o=(0,w.geByClass)("_feed_filter_row","feed_filters"),i=[],r=0;r<o.length;r++)(0,w.hasClass)(o[r],"hide")||i.push(o[r].id.replace("filter_updates",""));t+="&filters_shown="+i.join(",")}nav.go(t)},setNotifyFilter:function(e,t){(0,E.checkbox)(e),cur.notifyPrefs||(cur.notifyPrefs={}),cur.notifyPrefs[t]=(0,E.isChecked)(e),clearTimeout(cur.saveNotifyPrefsTO),cur.saveNotifyPrefsTO=setTimeout((function(){var e=[];(0,M.each)(cur.notifyPrefs,(function(t,o){e.push((o?"":"-")+t)})),e=e.join(","),ajax.post("/al_feed.php",{act:"a_set_notify_prefs",prefs:e,feed:1,hash:cur.topNotifyHash},{onDone:function(e){(0,M.addTemplates)({top_notify_prefs:e}),(0,w.toggleClass)("top_notify_pref_"+t,"checked",cur.notifyPrefs[t]),cur.notifyPrefs={},window.TopNotifier&&TopNotifier.invalidate(),nav.go(nav.strLoc),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)}})}),500)},updateTypesCookie:function(){var e=[];(0,M.each)(cur.my_feed_types,(function(t,o){"tabs"!=t&&e.push(!0===o?"*":o.join(","))})),(0,p.setCookie)("remixfeed",e.join("."),365)},toggleFeedTop:function(e,t,o){var i=(0,w.geByClass1)("_ui_toggler",e),r="top";switch((0,w.toggleClass)(i,"on"),cur.section){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"list":r=(0,w.hasClass)(i,"on")?"top":"recent";break;case"articles":r=(0,w.hasClass)(i,"on")?"suggested":"top";break;case"podcasts":r=(0,w.hasClass)(i,"on")?"recent":"top"}Je.switchSubSection(r,t,o)},switchList:function(e){cur.prevList=cur.list,cur.list=e,Je.setSection("list",1),uiRightMenu.go((0,w.geByClass1)("feed_section_list"+e),!1,!1),Je.go(Je.getSectionParams(cur.section))},setSearchSort:function(e){cur.search_sort_value=e,Je.submitSearch()},_activateReplyBox:function(e,t,o){(t||{}).cancelBubble=!0;var i=(0,w.ge)("reply_box"+e);if(cur.editing&&cur.editing!=e&&cur.notifyReplyData&&cur.notifyReplyData[cur.editing].disabled&&Je.notifyCheckHideReply(cur.editing,(window.event||{}).target),i&&(0,w.isVisible)(i))Je.notifyCheckHideReply(e,!1);else if(void 0===cur.notifyReplyData&&(cur.notifyReplyData={}),cur.notifyReplyData[e]=o,o.disabled){i?(0,w.show)(i):(0,w.ge)("feedback_row"+e).appendChild((0,w.se)((0,w.rs)(cur.options.feedback_dis,{item:e,text:o.disabled}))),setTimeout((function(){cur.editing=e}),0)}else{(0,w.show)(i),Wall.showEditReply(e,t);var r=(0,w.ge)("reply_field"+e);r.setAttribute("placeholder",o.ph),window.Emoji&&Emoji.val(r,o.greet.replace(/ $/,"&nbsp;")),(0,w.data)(r,"send",Je.notifySendReply),(0,w.removeClass)("reply_box"+e,"clear_fix")}},notifyClick:function(e,t,o){var i=(0,w.ge)("feedback_row"+e);Wall.checkPostClick(i,t)&&Je._activateReplyBox(e,t,o)},blindNotifyReply:function(e,t,o){Je._activateReplyBox(e,t,o)},notifySendReply:function(e,t,o){var i=cur.notifyReplyData[e];if(i&&!i.sending){var r,s=(0,w.ge)("reply_field"+e),n=(0,w.ge)("reply_button"+e),_=(0,w.ge)("feedback_row"+e),a=s&&(0,w.data)(s,"composer");if(o.stickerId)r={message:"",attach1_type:"sticker",attach1:o.stickerId};else{if((r=a?Composer.getSendParams(a,Je.notifySendReply.pbind(e)):{message:(0,M.trim)(Emoji.editableVal(s))}).delayed)return;if(!r.attach1_type&&(!r.message||i.greet&&!i.greet.indexOf(r.message)))return void Emoji.editableFocus(s,!1,!0)}(0,M.extend)(r,{act:"post",from:"feedback",item:e},i.params||{});var c=(0,w.ge)("reply_as_group"+e);c&&(0,w.isVisible)((0,w.domPN)(c))&&(r.from_oid=(0,w.domData)((0,w.domClosest)("_submit_post_box",c),"from-oid")),i.sending=1,ajax.post("al_wall.php",Wall.fixPostParams(r),{onDone:function(t,o){if(delete i.sending,a?Composer.reset(a):window.Emoji&&Emoji.val(s,""),s.autosize&&s.autosize.update(),Je.notifyHideReply(e),o){var r=(0,w.geByClass1)("_answer_wrap",_);(0,w.val)(r,o),(0,w.show)(r)}else t&&(0,h.showDoneBox)(t)},onFail:function(){delete i.sending},showProgress:()=>(0,E.lockButton)(n),hideProgress:()=>(0,E.unlockButton)(n)})}},notifyCheckHideReply:function(e,t){var o=cur.notifyReplyData&&cur.notifyReplyData[e];if(o&&!o.sending&&(0,w.isVisible)("reply_box"+e)){if(cur.editing=!1,!o.disabled){var i=(0,w.ge)("reply_field"+e),r=(0,M.trim)(window.Emoji?Emoji.editableVal(i):""),s=Wall.hasComposerMedia(i);if(!i||s||r&&!o.greet||o.greet.indexOf(r))return}Je.notifyHideReply(e)}},notifyHideReply:function(e){cur.editing==e&&(cur.editing=!1);var t=(0,w.ge)("feedback_row"+e);(0,w.removeClass)(t,"reply_box_open"),(0,w.hide)("reply_box"+e);var o=cur.replySubmitSettings;o&&o.tt&&o.tt.el&&o.tt.destroy()},notifyPostTooltip:function(e,t,o,i){var r=(o||{}).reply,s="al_wall.php";t.indexOf("topic_comment")?t=t.replace("wall_reply","").replace("wall",""):(s="al_board.php",t=t.replace("topic_comment","")),i=i||{},(0,C.showTooltip)(e,(0,M.extend)({url:s,params:(0,M.extend)({act:"post_tt",post:t,self:1,from:"feedback"},o||{}),slide:15,shift:[!r||r%2?27:329,6],ajaxdt:100,showdt:400,hidedt:800,dir:"auto",className:"rich wall_tt wall_module _feed_notification feed_notification",appendParentCls:"scroll_fix_wrap"},i))},getModuleRef:function(){var e=cur.module||"feed_other";return"feed"==cur.module&&(e="news"==cur.section?cur.subsection?"feed_news_"+cur.subsection:"feed_news":"podcasts"===cur.section?e+"_"+cur.section+("recent"===cur.subsection?"_my":""):cur.section?e+"_"+cur.section:"feed_other"),e},ignoreItem:function(e,t,o,i,r,s,n){var a;switch(void 0===s&&(s=0),void 0===n&&(n=""),e){case Q.VideosForYou:case Q.VideoPostcard:case Q.PhotoRecognize:case Q.RecommendedNarratives:case Q.YoulaRecommendationsCarousel:case Q.AliExpressRecommendationsCarousel:a=(0,w.ge)(e);break;default:a=(0,w.ge)("post"+e)}if(a){var c=a.getAttribute("data-ad"),l=(0,w.geByClass1)("ui_actions_menu_wrap",a),d=Je.getModuleRef();return l&&uiActionsMenu.toggle(l,!1),(0,_.revertLastInlineVideo)(a),t.includes("caption")?cur.feedEntriesHTML[e+"_ignored"]=(0,w.val)(a):cur.feedEntriesHTML[e]=(0,w.val)(a),new Promise(((_,l)=>{ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:e,feed_raw:t,caption_type:i,uids:r,hash:o,ad_data:c,ref:d,session_id:cur.feed_session_id,module:Je.getModuleRef(),position:(0,M.indexOf)((0,w.domPN)((0,w.domPN)(a)).children,(0,w.domPN)(a)),reason_id:s,track_code:n},{onDone:function(e,t){Je.destroyPhotoCarouselByPost(a),(0,w.val)(a,e),(0,v.evalWithLogging)(t),_()},onFail:()=>(l(),!0),stat:[window.jsc("web/privacy.js"),"privacy.css"]})}))}},unignoreItem:function(e,t,o,i){var r=Je.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_item",post_raw:e,feed_raw:t,hash:o,ref:r},{onDone:function(){t.includes("caption")?(0,w.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):Je.restorePost(e)},showProgress:i&&E.lockButton.pbind(i),hideProgress:i&&E.unlockButton.pbind(i)})},reportIgnoredItem:function(e,t){ajax.post("al_wall.php",{act:"spam",post:e,hash:t},{onDone:function(t){var o=(0,w.ge)("post"+e),i=o&&(0,w.geByClass1)("feed_post_report",o,"div");(0,w.val)(i,t)}})},ignoreOwner:function(e,t,o,i,r){e&&(cur.feedEntriesHTML[e+"_ignored"]=(0,w.val)("post"+e));var s="list"==cur.section&&cur.list||0,n=Je.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,type:o,hash:i,list:s,ref:n},{onDone:function(o){(0,w.val)("post"+e,o),(0,M.each)((0,w.geByClass)("post",cur.rowsCont),(function(o,i){var r=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);r&&r[1]!=e&&(!r[4]&&r[2]==t||r[4]&&r[3]==t)&&((0,_.revertLastInlineVideo)(this),(0,w.hide)(this.parentNode))}))},showProgress:()=>j.FlatButton.lock(r),hideProgress:()=>j.FlatButton.unlock(r)})},unignoreOwner:function(e,t,o,i){var r="list"==cur.section&&cur.list||0,s=Je.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,hash:o,list:r,ref:s},{onDone:function(o){e?(0,w.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):(0,w.val)("ignore_row"+t,o),(0,M.each)((0,w.geByClass)("post",cur.rowsCont),(function(e,o){var i=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);i&&(!i[4]&&i[2]==t||i[4]&&i[3]==t)&&(0,w.show)(this.parentNode)}))},showProgress:()=>j.FlatButton.lock(i),hideProgress:()=>j.FlatButton.unlock(i)})},ignoreGroupWall:function(e,t,o,i){e&&(cur.feedEntriesHTML[e+"_ignored"]=(0,w.val)("post"+e));var r=Je.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,ignore_type:"group_wall",hash:o,ref:r},{onDone:function(t){(0,w.val)("post"+e,t)},showProgress:()=>j.FlatButton.lock(i),hideProgress:()=>j.FlatButton.unlock(i)})},unignoreGroupWall:function(e,t,o,i){var r=Je.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,ignore_type:"group_wall",hash:o,ref:r},{onDone:function(o){e?(0,w.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):(0,w.val)("ignore_row"+t,o)},showProgress:()=>j.FlatButton.lock(i),hideProgress:()=>j.FlatButton.unlock(i)})},ignoreLiveOwner:function(e,t,o,i){var r=(0,w.ge)("post"+e),s=(0,w.geByClass1)("ui_actions_menu_wrap",r);s&&uiActionsMenu.toggle(s,!1),(0,_.revertLastInlineVideo)(r),cur.feedEntriesHTML[e+"_ignored"]=(0,w.val)("post"+e),ajax.post("al_feed.php?act=a_ignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){(0,w.val)("post"+e,t)},showProgress:i&&E.lockButton.pbind(i),hideProgress:i&&E.unlockButton.pbind(i)})},unignoreLiveOwner:function(e,t,o,i){ajax.post("al_feed.php?act=a_unignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){(0,w.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"])},showProgress:i&&E.lockButton.pbind(i),hideProgress:i&&E.unlockButton.pbind(i)})},unsubscribe:function(e,t,o){(0,f.triggerEvent)((0,w.ge)("post_delete"+e),"mouseout"),cur.feedEntriesHTML[e]=(0,w.ge)("post"+e).innerHTML;var i=e.match(/(\-?\d+)_(photo|video|shortVideo|topic|note|market|)(\d+)/);i&&ajax.post("al_feed.php",{act:"unsubscribe",type:{"":24,photo:21,video:22,shortVideo:26,topic:20,note:23,market:25}[i[2]],owner_id:i[1],place_id:i[3],hash:t,feed:1},{onDone:function(t){(0,w.ge)("post"+e).innerHTML=t.replace("%post_raw%",e)},showProgress:o&&E.lockButton.pbind(o),hideProgress:o&&E.unlockButton.pbind(o)})},subscribe:function(e,t,o){var i=e.match(/(\-?\d+)_(photo|video|shortVideo|topic|note|market|)(\d+)/);i&&ajax.post("al_feed.php",{act:"subscribe",type:{"":24,photo:21,video:22,shortVideo:26,topic:20,note:23,market:25}[i[2]],owner_id:i[1],place_id:i[3],hash:t,feed:1},{onDone:Je.restorePost.pbind(e),showProgress:o&&E.lockButton.pbind(o),hideProgress:o&&E.unlockButton.pbind(o)})},restorePost:function(e){var t;if(e===Q.PhotoRecognize)t=(0,w.ge)(e);else t=(0,w.ge)("post"+e);if(t){t.innerHTML=cur.feedEntriesHTML[e],Je.initPhotoCarouselInPost(t);var o=(0,w.geByClass1)("input_back",t,"div"),i=(0,w.geByTag1)("textarea",t);i&&(i.placeholder=o.innerHTML,o.parentNode.removeChild(o),(0,b.placeholderSetup)(i))}},toggleReposts:function(e,t,o,i){if((0,f.checkEvent)(i))return!0;var r=(0,w.ge)("feed_reposts_more"+t+"_"+o),s=(0,w.ge)("feed_reposts"+t+"_"+o),n=0,_=(0,g.scrollGetY)(),c=(0,w.isVisible)(s);if(s)return c?n-=s.offsetHeight+(0,M.intval)((0,w.getStyle)(e,"marginTop")):((0,w.domPN)((0,w.domPN)(s))||{}).bits=0,(0,w.toggle)(s,!c),j.FlatButton.setLabel(r,c?(0,a.getLang)("news_show_X_reposts",s.childNodes.length):(0,a.getLang)("news_hide_reposts")),n&&(0,g.scrollToY)(_+n+(0,w.getSize)("page_header")[1],0),!1;r&&(0,w.re)(r.parentNode.parentNode)},editHidden:function(){return(0,P.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"feed",height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=Je.onHiddenSave,!1},onHiddenSave:function(e,t,o,i){var r=(0,h.curBox)(),s={act:"a_ignore_olist",no_reposts:(0,w.ge)("feed_list_reposts")&&!(0,E.isChecked)("feed_list_reposts")?1:0,hash:i.hash};return e.length<t.length?s.White=e.join(","):s.Black=t.join(","),ajax.post("al_feed.php",s,{onDone:function(e,t){r.hide(),Je.switchSection("photos"==cur.section?"photos":"news")},showProgress:E.lockButton.pbind(r.btns.ok[0]),hideProgress:E.unlockButton.pbind(r.btns.ok[0])}),!1},addList:function(){return Je.editList(-1)},editList:function(e){return Je.toggleTabsMenu(!1,0),(0,P.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"feed",list_id:e,height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")],onFail:function(e){return setTimeout((0,P.showFastBox)({title:(0,a.getLang)("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e,(0,a.getLang)("global_close")).hide,4500),!0}}),cur.onOListSave=Je.onListSave.pbind(e),!1},onListSave:function(e,t,o,i,r){var s=(0,w.val)("feed_list_name");if(!(0,M.trim)(s))return(0,E.notaBene)("feed_list_name"),!1;if(!t.length)return!1;var n=(0,h.curBox)();return ajax.post("al_feed.php",{act:"a_save_list",hash:cur.tabs_hash,White:t.join(","),title:s,list_id:e,no_reposts:(0,w.ge)("feed_list_reposts")&&!(0,E.isChecked)("feed_list_reposts")?1:0},{onDone:function(t){var o=(0,w.geByClass1)("feed_section_list"+e,cur.feedEls.rmenu),i=(0,w.geByClass1)("feed_filter_list"+e,cur.feedEls.rmenu),r=uiRightMenu.selectLabelNode(o);(0,w.val)(r,(0,M.clean)(s)),(0,w.val)((0,w.geByClass1)("ui_actions_menu_item_label",i),(0,M.clean)(s)),n.hide(),e>0?Je.switchList(e):nav.go({0:"feed",section:"list",list:t},null,{nocur:!0})},onFail:function(e){return(0,w.val)("feed_list_error",e),(0,w.show)("feed_list_error_wrap"),!0},showProgress:E.lockButton.pbind(n.btns.ok[0]),hideProgress:E.unlockButton.pbind(n.btns.ok[0])}),!1},deleteList:function(e,t,o,i){if(i&&(0,f.cancelEvent)(i),e<=0)return!1;if(o){var r=(0,h.curBox)();ajax.post("al_feed.php",(0,M.extend)({act:"a_delete_list",list_id:e,hash:cur.tabs_hash}),{onDone:function(){(0,w.re)((0,w.geByClass1)("feed_section_list"+e,cur.feedEls.rmenu)),(0,w.re)((0,w.geByClass1)("feed_filter_list"+e,cur.feedEls.rmenu)),boxQueue.hideAll(),"list"==cur.section&&cur.list==e&&Je.switchSection("news")},showProgress:E.lockButton.pbind(r.btns.ok[0]),hideProgress:E.unlockButton.pbind(r.btns.ok[0])})}else{Je.toggleTabsMenu(!1,0);var s=(0,P.showFastBox)({title:(0,a.getLang)("news_delete_list_sure_title"),bodyStyle:"padding: 20px; line-height: 160%;"},(0,a.getLang)("news_delete_list_sure").replace("{list}",t),(0,a.getLang)("global_delete"),(function(){Je.deleteList(e,t,!0)}),(0,a.getLang)("global_cancel"),(function(){s.hide()}))}},saveTabs:function(){ajax.post("al_feed.php",{act:"a_save_tabs",hash:cur.tabs_hash,tabs:cur.my_feed_types.tabs.join(",")},{hideProgress:function(){(0,G.isFunction)(cur.onSaveTabs)&&cur.onSaveTabs(),cur.onSaveTabs=null}})},statsShow:function(e,t){return(0,u.showWiki)({w:"stats"+(cur.source||"")},!1,e)},editLiveBlacklist:function(e){(0,f.cancelEvent)(e),(0,P.showBox)("al_video.php?act=live_blacklist_box",{},{onDone:function(e,t){Y.init(e,t)},stat:["videoview.js","videoview.css",window.jsc("web/indexer.js")]})},scrollCheck:(0,V.debounce)((function(e){if("scroll"==(e=e||{}).type||cur.idleManager&&!cur.idleManager.isIdle){var t,o,i,r,s,n,_=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,a=(0,g.scrollGetY)(),c=0,l=[];if(!cur.isFeedLoading&&!cur.disableAutoMore){var d=(0,w.ge)("show_more_link");(0,w.isVisible)(d)&&a+_+1e3>d.offsetTop&&Je.showMore()}if((0,w.domPN)(cur.topRow)==cur.rowsCont&&"feed_rows_next"!=(cur.topRow||{}).id||(cur.topRow=(0,w.domFC)(cur.rowsCont)),vk.id&&cur.topRow&&"feed_rows_next"!=cur.topRow.id&&(!((window.curNotifier||{}).idle_manager||{}).is_idle||"init"==e.type)){var u,h,p=[];for(r=(0,w.domPS)(cur.topRow);r;r=(0,w.domPS)(r))cur.topRow.offsetTop>a&&(cur.topRow=r),r.unseen||(r.unseen=!0,p.push(Z(r)),h=void 0,(h=(u=r)&&(0,w.domFC)(u))&&h.hasAttribute("data-ad-stat-show_off")&&Wall.triggerAdStat((0,w.domFC)(r),"show_off"));for(Page.postsUnseen(p),r=cur.topRow;r&&!((t=c||r.offsetTop)>=a+_);r=s)if("feed_rows_next"==((s=(0,w.domNS)(r))||{}).id&&(s=null),(c=s?s.offsetTop:t+r.offsetHeight)<a&&s&&(cur.topRow=s),LongView&&LongView.register(r,"feed"),_e(r),!((n=r.bits||0)>=3)){var f;if(cur.feedSeenPostHeight>0)cur.feedPostHeaderHeight=cur.feedPostHeaderHeight||(0,w.getH)(null==(f=r)||null==f.querySelector?void 0:f.querySelector(".post_header, .js-PostHeader")),i=(o=t+cur.feedPostHeaderHeight)+cur.feedSeenPostHeight,r.postBottom||(r.postBottom=o+(0,w.getH)((0,w.geByClass1)("wall_text",r))),n|=(o>=a&&o<a+_?1:0)|((i=Math.min(i,r.postBottom))>=a&&i<a+_?2:0);else n|=(t>=a&&t<a+_?1:0)|(c>=a&&c<a+_?2:0);if(n&&(r.bits=n,3==n)){var v,b=Z(r);if(te(r)||ee(r)?Wall.triggerAdStat((0,w.domFC)(r),"impression"):l.push(b),(0,w.geByClass1)("VideosForYouGallery",r))null==(v=window.FeedVideosForYou)||v.viewBlock();else if((0,w.geByClass1)("FeedVideoPostcard",r)){var P;null==(P=window.FeedVideoPostcard)||P.viewBlock()}else(0,w.geByClass1)("feed_friends_recomm",r)?function(){var e=(0,w.geByClass1)("ui_gallery",r),t=(0,w.domData)(e,"from"),o=(0,w.domData)(e,"code")||"";T(["view_block",t,b.index,(0,G.vkNow)(),b.module,o],!0);var i=(0,m.uiGetGallery)(e);i&&i.getVisibleItems().forEach((function(e){R(e[0],e[1],t)})),e.visible=!0}():(0,w.geByClass1)("js-feed_groups_recomm",r)?S(r):r.querySelector("#feed_mini_apps_recomm")&&window.RecommendedMiniApps.viewBlock()}}l=l.concat(ne(a,_)),LongView&&LongView.onScroll(a,_),Page.postsSeen(l);var C=(0,w.ge)("show_more_link"),M=C.offsetTop;if(!C.seen&&M>=a&&M<a+_){C.seen=Date.now();var D=cur.section+(cur.subsection?"_"+cur.subsection:"");(0,y.statlogsValueEvent)("feed_load_more_seen",(0,E.isButtonLocked)(C),D)}}}}),20),searchUpdate:function(){var e;cur.feedEls.search&&(0,a.getLang)("news_search")&&(e=cur.section.indexOf("photos")?cur.section.indexOf("articles")?(0,a.getLang)("news_search"):(0,a.getLang)("news_articles_search"):(0,a.getLang)("news_photo_search"),cur.feedEls.search.setAttribute("placeholder",(0,M.clean)((0,G.unclean)(e))),(0,b.placeholderInit)(cur.feedEls.search,{reload:!0}))},go:function(e,t,o){if(e=e||{},cur._back_local){var i=cur._back_local;i.back?(0,d.showBackLink)(i.back[0],i.back[1],i.back[2]):(0,d.showBackLink)(!1),cur._back_local=!1}if(cur.feedReq)try{cur.feedReq.abort()}catch(e){(0,c.debugLog)(e)}cur.feedReqObj=null;var r=1,a=function(){cur.isFeedLoading=!1};(s.browser.msie||o)&&(r=!1,a=cur.onFrameBlocksDone),cur.wasScroll=!!o&&(0,g.scrollGetY)();var u=window.event&&window.event.target;if(u&&"search"===e.section&&!e._post){var h=nav.getPostParams(u);if(h.post_id&&h.post_click_type){function t(t,o){t&&!e[o]&&(e[o]=t)}t(h.post_id,"_post"),t(h.post_click_type,"_post_click_type"),t(h.post_click_url,"_post_click_url"),t(h.post_click_mention_id,"_post_click_mention_id"),t(h.post_click_cc_key,"_post_click_cc_key"),t(h.ad_data,"_post_ad_data"),t(h.ad_block_unique_id,"_post_ad_block_unique_id")}}var p=cur.feedReqObj={},f={},m=0,b=()=>{if(cur.feedReqObj&&cur.feedReqObj===p&&!(++m>500)){var e=!0,t={};(0,M.each)(f,(function(o){var i=(0,w.ge)(o);if(i&&(0,w.hasClass)(i,"feed_row"))return i.firstChild?void Je.onPostLoaded(i,!0):(t[o]=!0,void(e=!1))})),e||(f=t,setTimeout(b,100))}},E=+new Date;cur.feedReq=ajax.post("al_feed.php",(0,M.extend)(e,{part:1}),{onDone:function(o,i,s,a,c){if(cur.feedEls){if((0,_.revertLastInlineVideo)(),(0,w.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,window.tooltips&&tooltips.destroyAll((0,w.ge)("feed_rows")),boxQueue.hideAll(),layers.fullhide&&!cur.storyLayer&&layers.fullhide(!0),r&&ajax._framenext(),window.wall&&Wall.cancelEdit(),boxQueue.hideAll(),t?t(i||""):(0,w.val)(cur.rowsCont,i||""),Je.applyOptions(o,2),!e.norecom&&"notifications"!==e.section){(0,w.val)("feed_recommends",o.recommends||""),(0,w.toggle)("feed_recommends",!!o.recommends);var d="/al_feed.php#"+AjaxConvert.toQueryString({act:"recom"});ajaxCache[d]&&delete ajaxCache[d],(0,w.toggleClass)(cur.feedEls.wrap,"feed_asc_shown",(0,w.geByClass1)("feed_asc_block","feed_recommends"))}var u;if(s&&(0,v.evalWithLogging)(s),(0,l.checkPageBlocks)(),(0,g.scrollToTop)(0),(0,n.shortCurrency)(),cur.feedEls.wall)switch(u="clear_fix",cur.section){case"updates":u+=" page_block feed_updates";break;case"photos_search":u+=" page_block feed_found_photos";break;case"notifications":u+=" page_block feed_notifications";break;case"coronavirus":case"stayhome":u+=" feed_wall--with-header"}if((0,w.ge)("feed_wall").className=u,(0,w.toggle)("feed_recommends",(0,M.inArray)(cur.section,["news","recommended","videos"])),(0,w.val)("feed_app_widget",a||""),(0,w.toggle)("feed_app_widget",a),a&&c&&(0,v.evalWithLogging)(c),cur.rowsCont&&cur.rowsCont.children&&((0,M.each)(cur.rowsCont.children,(function(){var e=this;(0,w.hasClass)(e,"feed_row")&&(!e.id||e.firstChild?Je.onPostLoaded(e,!0):f[e.id]=!0)})),(0,G.isEmpty)(f)||setTimeout(b,10)),cur.q){var h="photos_search"===cur.section?y.servicePhotos:y.serviceNews,p=+new Date-E;(0,y.saveSearchAttemptStats)(h,0,cur.count,(0,w.val)(cur.feedEls.search),0,0,p),(0,Le.updateCounters)(location.href,document.referrer)}setTimeout(Je.scrollCheck,200)}},onFail:function(){return!1},showProgress:function(){cur.isFeedLoading=!0},frame:r,ads:1,hideProgress:a})},onFeedSearch:function(e,t,o,i){t||(0,y.removeSearchPositionTracker)("photos");var r,s,n=i||cur.section;if(n.indexOf("photos")?n.indexOf("trends")?n.indexOf("articles")?(r="search",s="news"):(r="articles_search",s="articles"):(r="trends_search",s="trends"):(r="photos_search",s="photos"),"search"==r||Je.hasSearchParams(Je.getSectionParams(r))){r!=cur.section&&Je.setSection(r,1);var _=Je.getSectionParams(r);cur.disableSort&&(_.disable_sort=1),Je.go(_),window.searcher&&F.searcher.highlightHotHashtag(t||(0,w.val)(e))}else Je.go(Je.getSectionParams(s));uiSearch.onChanged(e),uiSearch.showProgress(e)},onSearchChange:function(){return setTimeout(Je.onFeedSearch.pbind(cur.feedEls.search),0),!1},init:function(e){var t,o,i,r;setTimeout((function(){(0,M.each)((0,w.geByTag)("textarea",cur.rowsCont),(function(){(0,b.placeholderSetup)(this)})),cur.q&&(0,y.saveSearchAttemptStats)("photos_search"===cur.section?y.servicePhotos:y.serviceNews,0,cur.count,(0,w.val)(cur.feedEls.search))}),200),(0,M.extend)(cur,{oid:e.user_id,postTo:e.user_id,phCache:{},phShown:{},subsections:{},feed_session_id:e.feed_session_id||"na",module:"feed",isFeedLoading:!1,customSearchChange:Je.onSearchChange,navParams:e.nav_params||{},wallPostCb:function(){"news"==cur.section?setTimeout(Je.update.pbind(1),1e3):setTimeout(Je.switchSection.pbind("news"),1e3)},idleManager:(r={isIdle:!1,onIdle:null,onUnIdle:null,stop:function(){(0,f.removeEvent)(document,"mousemove keydown",t),(0,f.removeEvent)(window,"focus blur",i)},start:function(){s.browser.mobile||(t=function(){cur.idleManager&&r.isIdle&&(r.isIdle=!1,r.onUnIdle&&r.onUnIdle())},o=function(){cur.idleManager&&(r.isIdle=!0,r.onIdle&&r.onIdle())},i=function(e){"focus"==e.type?t():o()},(0,f.addEvent)(window,"focus blur",i))}},r),currentModule:function(){return"videos"==cur.section?"feed_videos":cur.module},onFrameBlocksDone:function(){cur.isFeedLoading=!1,(0===cur.wasScroll||cur.wasScroll>0||!1===cur.wasScroll&&"search"==cur.section&&cur.q&&"#"==cur.q.substr(0,1))&&(cur.wasScroll=!1)},feedEntriesHTML:{},feedUnreadCount:0,feedInitialTitle:"",feedUnread:[],feedToSort:[],feedEls:{wrap:(0,w.ge)("main_feed"),wall:(0,w.ge)("feed_wall"),search:(0,w.ge)("search_query"),rmenu:(0,w.ge)("feed_rmenu"),newPosts:(0,w.ge)("feed_new_posts")}}),cur.nav.push((function(e,t,o,i){if(void 0===e[0]){var r=(0,M.clone)(o);if(delete r[0],void 0===e.section||(0,M.inArray)(cur.section,["notifications","replies"])==(0,M.inArray)(e.section,["notifications","replies"])){if("notifications"==cur.section)return Je.switchNotifyList(o.list||"all",(0,M.extend)(r,i.params||{})),!1;if(e.list)return Je.switchList(e.list),!1;if(void 0!==e.section&&Je.switchSection(e.section||"news",!1,!0),e.notify)return!1;if(e.q)return(0,w.val)(cur.feedEls.search,e.q),Je.onFeedSearch(cur.feedEls.search),!1;if(delete e.subsection,(0,G.isEmpty)(e)){var s=(0,w.geByClass1)("feed_section_"+(t.section||"news")+(t.list||""));s&&uiRightMenu.go(s,!1,!1)}return cur.likesTabTT&&cur.likesTabTT.destroy(),Je.go((0,M.extend)(r,i.params||{})),!1}}})),cur.idleManager.onUnIdle=Je.updateTitle,cur.idleManager.onIdle=Je.reSortItems,cur.options=cur.options||{},(0,M.extend)(cur.options,e),Je.applyOptions(e,3),cur.rowsCont=e.wallCont=(0,w.ge)("feed_rows"),Wall.init(e),cur.rowsCont&&cur.rowsCont.children&&(0,M.each)(cur.rowsCont.children,(function(){var e=this;(0,w.hasClass)(e,"feed_row")&&e.firstChild&&Je.onPostLoaded(e,!0)})),cur._back={text:(0,a.getLang)("news_return_to_news"),show:[Je.startEvents],hide:[function(){clearInterval(cur.updateInt),(0,f.removeEvent)(window,"scroll",Je.scrollCheck),(0,f.removeEvent)(window,"resize",Je.scrollCheck),cur.idleManager.stop(),clearTimeout(cur.lp_error_to)}],loc:!1},Je.startEvents(),A(!0),setTimeout((function(){Je.scrollCheck({type:"init"})}),200)},startEvents:function(){cur.idleManager.start(),cur.updateInt=setInterval((function(){Je.update(0)}),2e4),(0,f.addEvent)(window,"scroll",Je.scrollCheck),(0,f.addEvent)(window,"resize",Je.scrollCheck)},mentionClick:function(e,t){var o=e,i=((e.getAttribute("mention")||"").match(/^bp(-?\d+_\d+)$/)||{})[1];if(!i)return nav.go(e,t);for(i=i.split("_");e;e=e.parentNode){var r=(e.id||"").match(/^replies(-?\d+_topic\d+)$/);if(r){if(r[1].split("_")[0]==i[0])return Wall.showReply(o,r[1],i[0]+"topic_"+i[1],t);break}}return nav.go(e,t)},toggleCustomFeedTab:function(e,t){return(0,w.hasClass)(e,"feed_tab_link_hidden")?((0,w.removeClass)(e,"feed_tab_link_hidden"),(0,p.setCookie)("remixcustom_feed_added",t)):(0,E.lockButton)(e),Je.checkTabsFilter((0,w.geByClass1)("_feed_custom_"+t),t)},recomSubscribe:function(e,t,o){var i,r,s=o?t:(0,w.domPS)(t),n=o?(0,w.domNS)(t):t;o?(i="/al_feed.php",r={act:"subscr",oid:e,from:nav.objLoc.section,hash:(0,w.val)("feed_recom_hash")}):(i="/al_fans.php",r={act:"unsub",oid:e,hash:(0,w.val)("feed_recom_hash"),no_response:1}),ajax.post(i,r,{onDone:function(){(0,w.toggle)(s,!o),(0,w.toggle)(n,!!o),"recommended"!=nav.objLoc.section&&nav.go(nav.objLoc,!1,{params:{norecom:1}})},showProgress:()=>(0,E.lockButton)(t),hideProgress:()=>(0,E.unlockButton)(t)})},clickBlogReminder:function(e,t,o,i,r,s){if(ajax.post("blog.php",{act:"click_reminder",hash:i,nid:t,accept:1,target:s},{onDone:function(){}}),"_blank"!==(0,w.attr)(e,"target"))return(0,f.cancelEvent)(r),nav.go(o)},hideBlogReminder:function(e,t,o,i){o&&(0,f.cancelEvent)(o),(0,w.re)("feed_blog_reminder"),ajax.post("blog.php",{act:"hide_reminder",hash:e,nid:t,accept:0,target:i},{onDone:function(){}})},preloadVideos:function(e){function t(e){var t=new XMLHttpRequest;t.open("GET",e),t.send()}e&&cur.videoAutoplayScrollHandler&&(cur.videoAutoplayPreloaded=cur.videoAutoplayPreloaded||{},(0,M.each)(e,(function(e,o){t(o.index_url),t(o.index_url.replace(/index-(.+).m3u8/,"seg-1-$1.ts")),cur.videoAutoplayPreloaded[o.video]=o.quality})))},expandJoinedGroups:function(e,t){return(0,f.cancelEvent)(t),(0,w.show)((0,w.geByClass1)("feed_groups_hidden_list",e.parentNode)),(0,w.re)(e),!1},showAllFilters:function(e){(0,w.re)(e);for(var t=(0,w.geByClass)("hide",e.parentNode),o=0;o<t.length;o++)(0,w.removeClass)(t[o],"hide")},toggleSubscription:function(e,t,o,i,r){var s=(0,w.domClosest)("_ui_menu_wrap",e);s&&uiActionsMenu.toggle(s,!(0,w.hasClass)(s,"shown")),Page.toggleSubscription(e,t,o,i,r,(function(e,t){(0,w.geByClass)("post",cur.rowsCont).forEach((function(o){var r=o.id.split("_"),s=+r[r.length-2].replace("post","");if(i===s){var n=(0,w.geByClass1)("page_action_subscribe",o);(0,w.val)(n,e),(0,w.domData)(n,"act",t)}}))}))},onPostLoaded:function(e,t){Wall.onPostLoaded(e,t),this.initPrettyCardGallery(e),t&&!(0,w.hasClass)(e,"_post")&&Je.initPhotoCarouselInPost((0,w.geByClass1)("_post",e))},openPostSuggest:function(e,t,o){if(t&&null!=t.type)switch(t.type){case 1:var i=t.postData,r=t.notHideByClick,s=(0,w.ge)("post_field");return void((s?(0,M.trim)(s.innerHTML).replace("<br>",""):"")||cur.wallAddMedia&&cur.wallAddMedia.attachCount()?(0,P.showFastBox)({title:(0,a.getLang)("news_suggest_alert_title"),dark:1},(0,a.getLang)("news_suggest_alert_text"),(0,a.getLang)("global_yes"),(function(){(0,h.curBox)().hide(),n(i,r)}),(0,a.getLang)("global_cancel")):n(i,r));case 4:return window.open(t.link),void Je.suggestionEvent(e,"open",o,t.notHideByClick)}function n(t,i){void 0===i&&(i=!1),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),cur.options&&(cur.options.situational_suggest_id=e),t[0]=t[0].replace(/<br>/g,"\n");var r=cur.editing;delete cur.editing,Wall.setDraft(t),Je.suggestionEvent(e,"open",o,i),cur.editing=r}},suggestionEvent:(e,t,o,i)=>(ajax.post("al_feed.php",{act:"suggestion_event",suggest_id:e,event_type:t,not_hide_by_click:(0,M.intval)(i)}),i||(0,w.re)((0,w.geByClass1)("_post_suggest")),(0,f.cancelEvent)(o)),closePostSuggest(e,t,o){Je.suggestionEvent(e,t,o,!1)},hideRightBlock:function(e,t,o){var i=(0,w.domCA)(e,".page_block");return(0,w.re)(i),ajax.post("al_feed.php",{act:"a_hide_right_block",block_type:t,app_id:e.dataset.app_id||0,hash:o}),!1},initPrettyCardGallery:function(e){if(!(0,w.geByClass1)("pretty-cards",e))return!1;window.PrettyCardGallery&&new window.PrettyCardGallery(e)},initPhotoCarouselInPost(e){if(e){var t=function(e,t){var o=e.querySelector(".PhotoCarousel");if(o)try{return o.classList.contains("PhotoCarousel--recognize")?new Te(e):new we(e,{sendAnalytic:t})}catch(e){console.error(e),(0,K.logError)(e)}}(e,Je.sendPhotoCarouselEvent.bind(Je));(0,w.data)(e,"photo_carousel",t),window.cur.destroy.push((()=>{(0,w.removeData)(e,"photo_carousel")}))}},destroyPhotoCarouselByPost(e){var t=(0,w.data)(e,"photo_carousel");t&&t.destroy()},sendPhotoCarouselEvent(e,t,o){if(void 0===o&&(o=null),t){var i=t.querySelector(".post_img"),r=i&&i.getAttribute("data-post-id");if(r){var s,n,_=r.match(/(-?\d+)_p(\d+)/);if(_&&_[1]&&_[2]){s=_[1],n=_[2];var a=t.getAttribute("data-photo-raw-id"),c=t.getAttribute("data-pseudopost-type"),l=t.getAttribute("data-post-creation-timestamp");if(!a&&"photo_group"===c&&o){var d=o.target;if(d&&d.href){var u=d.href.match(/\/photo(-?\d+_\d+)/);a=u&&u[1]}}var h={event_type:e,content_type:c,post_owner_id:s,post_id:n,photo_raw_id:a,timestamp:l,ref:Je.getModuleRef()};(0,y.statlogsValueEvent)("feed_new_carousel_stat",h)}}}},disablePhotoRecognizeBlock(e){var t=document.getElementById(`${Q.PhotoRecognize}`);t&&(cur.feedEntriesHTML[`${Q.PhotoRecognize}_ignored`]=(0,w.val)(t),ajax.post("al_feed.php",{act:"disable_recognize_block",hash:e},{onDone:e=>{(0,w.val)(t,e)}}))},enablePhotoRecognizeBlock(e){var t=document.getElementById(`${Q.PhotoRecognize}`);t&&ajax.post("al_feed.php",{act:"enable_recognize_block",hash:e},{onDone:()=>{(0,w.val)(t,cur.feedEntriesHTML[`${Q.PhotoRecognize}_ignored`])}})}};window.feed=Je,window.Feed=Je;try{window.stManager.done(window.jsc("web/feed.js"))}catch(e){}},10124:(e,t,o)=>{o.d(t,{createMutations:()=>n,createModule:()=>c,destroyModule:()=>l});var i=o(70655),r=o(67784),s=o(49535);function n(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(t),!1))}}}function _(e,t,o,i){(0,s.addEvent)(t,o,i),e._registeredHandlers.push({handlerType:"bind",elem:t,types:o,handler:i})}function a(e,t,o,i,s,n){(0,r.addDelegateEvent)(t,o,i,s,n),e._registeredHandlers.push({handlerType:"delegate",elem:t,types:o,selector:i,handler:s})}function c(e){var t={_registeredHandlers:[]};return e.handlers((function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return _.apply(void 0,(0,i.__spreadArray)([t],(0,i.__read)(e),!1))}),(function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return a.apply(void 0,(0,i.__spreadArray)([t],(0,i.__read)(e),!1))})),t}function l(e){e._registeredHandlers.forEach((function(e){var t=e.handlerType,o=e.elem,i=e.types,n=e.handler;"delegate"===t?(0,r.removeDelegateEvent)(o,i,e.selector,n):(0,s.removeEvent)(o,i,n)})),e._registeredHandlers=[]}},50733:(e,t,o)=>{o.d(t,{initSearchStatusFilters:()=>h});var i=o(70655),r=o(40906),s=13;var n=o(79957),_=o(15544),a=o(49535),c=o(416),l=o(86067),d=o(76852),u=o(49034);function h(e){var t,o=e.selData,h=e.contentHint,p=function(e){e.keyCode!=s&&"keydown"==e.type||window.searcher.updResults()};window.radioBtns.sort={els:(0,i.__spreadArray)([],(0,i.__read)(document.querySelectorAll("#cSort .radiobtn")),!1),val:o.sort},window.cur.onSortChanged=function(e){var t=e.querySelector("._ui_toggler");if(t){t.classList.toggle("on");var o=t.classList.contains("on")?1:0;"search"==window.cur.section&&(0,n.statlogsValueEvent)("feed_change_sort",0,o),window.cur.disableSort=!o;var i=document.getElementById("c[sort]");i&&(i.value=String(o)),window.searcher.updResults()}},["exclude","url","content"].forEach((function(e){var t,o=document.querySelector("#search_status_"+e);if(o){var i=function(){!function(e){window.cur.searchReq||(0,_.val)(e)!=(window.cur.params&&window.cur.params[e.name]||"")&&window.searcher.updResults()}(o)};(0,a.addEvent)(o,"blur",i),(0,a.addEvent)(o,"keydown change paste",p),null===(t=window.cur.destroy)||void 0===t||t.push((function(){(0,a.removeEvent)(o,"blur",i),(0,a.removeEvent)(o,"keydown change paste",p)})),(0,c.placeholderInit)(o)}})),["type","attach","likes"].forEach((function(e){var t=document.querySelector("#search_status_"+e);new window.Dropdown(t,o[e],{width:null,dark:!0,zeroPlaceholder:!0,onChange:window.searcher.updResults})}));var f=document.querySelector("#search_status_url");(0,a.addEvent)(f,"focus blur",(function(e){if(f)if("focus"==e.type){var t=('\n        <div id="search_status_hint_opts">\n          <div class="radiobtn on" onmousedown="return searchActions.searchUrlOnChange(this, 0, event);">'+(0,l.getLang)("news_searchext_link_hint")+'</div>\n          <div class="radiobtn" onmousedown="return searchActions.searchUrlOnChange(this, 1, event);">'+(0,l.getLang)("news_searchext_domain_hint")+"</div>\n        </div>\n      ").trim();(0,d.showTooltip)(f,{text:t,className:"search_status_hint_tt",shift:[324,-15,-15],slideX:-15,dir:"right",onCreate:function(){(0,a.removeEvent)(f,"mouseout"),window.radioBtns.search_status_hint_domain={els:(0,i.__spreadArray)([],(0,i.__read)(document.querySelectorAll("#search_status_hint_opts .radiobtn")),!1),val:0}}})}else f.tt&&f.tt.hide&&f.tt.hide()}));var g=document.querySelector("#search_status_content");(0,a.addEvent)(g,"focus blur",(function(e){g&&("focus"==e.type?(0,d.showTooltip)(g,{text:h,className:"search_status_hint_tt",shift:[324,-15,-15],slideX:-15,dir:"right",onCreate:function(){(0,a.removeEvent)(g,"mouseout")}}):g.tt&&g.tt.hide&&g.tt.hide())}));var m=document.querySelector("#search_status_map_hidden"),w=m?null===(t=(0,_.val)(m))||void 0===t?void 0:t.match(/(\-?\d{1,3}(?:\.\d+)?)\,(\-?\d{1,3}(?:\.\d+)?)(?:\,(\d+))?/):null;if(w){var v=(0,r.floatval)(w[1]),b=(0,r.floatval)(w[2]),E=w[3]||8;u.searchActions.chooseGeoPoint(v,b,E,!0)}}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.loaded=!0,o.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,o,i)=>{if(!t){var r=1/0;for(a=0;a<deferred.length;a++){for(var[t,o,i]=deferred[a],s=!0,n=0;n<t.length;n++)(!1&i||r>=i)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[n])))?t.splice(n--,1):(s=!1,i<r&&(r=i));if(s){deferred.splice(a--,1);var _=o();void 0!==_&&(e=_)}}return e}i=i||0;for(var a=deferred.length;a>0&&deferred[a-1][2]>i;a--)deferred[a]=deferred[a-1];deferred[a]=[t,o,i]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var o=Object.create(null);__webpack_require__.r(o);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var r=2&t&&e;"object"==typeof r&&!~leafPrototypes.indexOf(r);r=getProto(r))Object.getOwnPropertyNames(r).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(o,i),o},__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={12495:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,o)=>{var i,r,[s,n,_]=o,a=0;for(i in n)__webpack_require__.o(n,i)&&(__webpack_require__.m[i]=n[i]);if(_)var c=_(__webpack_require__);for(t&&t(o);a<s.length;a++)r=s[a],__webpack_require__.o(e,r)&&e[r]&&e[r][0](),e[s[a]]=0;return __webpack_require__.O(c)},o=self.webpackChunkvk=self.webpackChunkvk||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var __webpack_exports__=__webpack_require__.O(void 0,[76429,22897,75514,24509,40885,68592,46643],(()=>__webpack_require__(14350)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();